<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>王小二客栈</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.wenchong.top/"/>
  <updated>2018-05-16T08:45:18.459Z</updated>
  <id>http://www.wenchong.top/</id>
  
  <author>
    <name>小二</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Python——基础数据类型</title>
    <link href="http://www.wenchong.top/2018/05/16/Python%E5%AD%A6%E4%B9%A0%EF%BC%881%EF%BC%89%E2%80%94%E2%80%94%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <id>http://www.wenchong.top/2018/05/16/Python学习（1）——基本数据类型/</id>
    <published>2018-05-16T08:22:57.304Z</published>
    <updated>2018-05-16T08:45:18.459Z</updated>
    
    <content type="html"><![CDATA[<p>** Python 中的变量不需要声明。每个变量在使用前都必须赋值，变量赋值以后该变量才会被创建。<br>在 Python 中，变量就是变量，它没有类型，我们所说的”类型”是变量所指的内存中对象的类型。</p><p>等号（=）用来给变量赋值。</p><p>等号（=）运算符左边是一个变量名,等号（=）运算符右边是存储在变量中的值。例如： **</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"> </span><br><span class="line">counter = 100          # 整型变量</span><br><span class="line">miles   = 1000.0       # 浮点型变量</span><br><span class="line">name    = &quot;小二&quot;     # 字符串</span><br><span class="line"> </span><br><span class="line">print (counter)</span><br><span class="line">print (miles)</span><br><span class="line">print (name)</span><br></pre></td></tr></table></figure><p>运行实例 »<br>执行以上程序会输出如下结果：</p><p>100<br>1000.0<br>小二</p><ul><li>多个变量赋值<br>Python允许你同时为多个变量赋值。例如：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = b = c = 1</span><br></pre></td></tr></table></figure></li></ul><p>以上实例，创建一个整型对象，值为 1，三个变量都指向同一个内存位置。</p><p>您也可以为多个对象指定多个变量。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a, b, c = 1, 2, &quot;小二&quot;</span><br></pre></td></tr></table></figure></p><p>以上实例，两个整型对象 1 和 2 的分配给变量 a 和 b，字符串对象 “小二” 分配给变量 c。</p><ul><li>标准数据类型<br>Python3 中有六个标准的数据类型：</li></ul><p>Number（数字）<br>String（字符串）<br>List（列表）<br>Tuple（元组）<br>Sets（集合）<br>Dictionary（字典）<br>Python3 的六个标准数据类型中：</p><p>不可变数据（四个）：Number（数字）、String（字符串）、Tuple（元组）、Sets（集合）；<br>可变数据（两个）：List（列表）、Dictionary（字典）。</p><ul><li>Number（数字）<br>Python3 支持 int、float、bool、complex（复数）。</li></ul><p>在Python 3里，只有一种整数类型 int，表示为长整型，没有 python2 中的 Long。</p><p>像大多数语言一样，数值类型的赋值和计算都是很直观的。</p><p>内置的 type() 函数可以用来查询变量所指的对象类型。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a, b, c, d = 20, 5.5, True, 4+3j</span><br><span class="line">&gt;&gt;&gt; print(type(a), type(b), type(c), type(d))</span><br><span class="line">&lt;class &apos;int&apos;&gt; &lt;class &apos;float&apos;&gt; &lt;class &apos;bool&apos;&gt; &lt;class &apos;complex&apos;&gt;</span><br></pre></td></tr></table></figure></p><p>此外还可以用 isinstance 来判断：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a = 111</span><br><span class="line">&gt;&gt;&gt; isinstance(a, int)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></p><p>您也可以使用del语句删除一些对象引用。<br>del语句的语法是：</p><p>del var1[,var2[,var3[….,varN]]]]</p><ul><li>数值运算<br>实例：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;5 + 4  # 加法</span><br><span class="line">9</span><br><span class="line">&gt;&gt;&gt; 4.3 - 2 # 减法</span><br><span class="line">2.3</span><br><span class="line">&gt;&gt;&gt; 3 * 7  # 乘法</span><br><span class="line">21</span><br><span class="line">&gt;&gt;&gt; 2 / 4  # 除法，得到一个浮点数</span><br><span class="line">0.5</span><br><span class="line">&gt;&gt;&gt; 2 // 4 # 除法，得到一个整数</span><br><span class="line">0</span><br><span class="line">&gt;&gt;&gt; 17 % 3 # 取余 </span><br><span class="line">2</span><br><span class="line">&gt;&gt;&gt; 2 ** 5 # 乘方</span><br><span class="line">32</span><br></pre></td></tr></table></figure></li></ul><p>1、Python可以同时为多个变量赋值，如a, b = 1, 2。<br>2、一个变量可以通过赋值指向不同类型的对象。<br>3、数值的除法包含两个运算符：/ 返回一个浮点数，// 返回一个整数。<br>4、在混合计算时，Python会把整型转换成为浮点数。</p><ul><li>String（字符串）<br>Python中的字符串用单引号(‘)或双引号(“)括起来，同时使用反斜杠()转义特殊字符。</li></ul><p>字符串的截取的语法格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量[头下标:尾下标]</span><br></pre></td></tr></table></figure></p><p>索引值以 0 为开始值，-1 为从末尾的开始位置。</p><p>加号 (+) 是字符串的连接符， 星号 (*) 表示复制当前字符串，紧跟的数字为复制的次数。实例如下：</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"> </span><br><span class="line">str = &apos;xiaoer&apos;</span><br><span class="line"> </span><br><span class="line">print (str)          # 输出字符串</span><br><span class="line">print (str[0:-1])    # 输出第一个到倒数第二个的所有字符</span><br><span class="line">print (str[0])       # 输出字符串第一个字符</span><br><span class="line">print (str[2:5])     # 输出从第三个开始到第五个的字符</span><br><span class="line">print (str[2:])      # 输出从第三个开始的后的所有字符</span><br><span class="line">print (str * 2)      # 输出字符串两次</span><br><span class="line">print (str + &quot;TEST&quot;) # 连接字符串</span><br></pre></td></tr></table></figure></p><p>执行以上程序会输出如下结果：</p><p>xiaoer<br>xiaoe<br>x<br>aor<br>aoer<br>xiaoerxiaoer<br>xiaoerTEST</p><p>Python 使用反斜杠()转义特殊字符，如果你不想让反斜杠发生转义，可以在字符串前面添加一个 r，表示原始字符串：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(&apos;xi\aoer&apos;)</span><br><span class="line">xi</span><br><span class="line">aoer</span><br><span class="line">&gt;&gt;&gt; print(r&apos;xi\aoer&apos;)</span><br><span class="line">xi\aoer</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">`</span><br></pre></td></tr></table></figure></p><p>另外，反斜杠()可以作为续行符，表示下一行是上一行的延续。也可以使用 “””…””” 或者 ‘’’…’’’ 跨越多行。</p><p>注意，Python 没有单独的字符类型，一个字符就是长度为1的字符串。</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;word = &apos;Python&apos;</span><br><span class="line">&gt;&gt;&gt; print(word[0], word[5])</span><br><span class="line">P n</span><br><span class="line">&gt;&gt;&gt; print(word[-1], word[-6])</span><br><span class="line">n P</span><br></pre></td></tr></table></figure></p><p>与 C 字符串不同的是，Python 字符串不能被改变。向一个索引位置赋值，比如word[0] = ‘m’会导致错误。</p><p>注意：</p><p>1、反斜杠可以用来转义，使用r可以让反斜杠不发生转义。<br>2、字符串可以用+运算符连接在一起，用*运算符重复。<br>3、Python中的字符串有两种索引方式，从左往右以0开始，从右往左以-1开始。<br>4、Python中的字符串不能改变。</p><ul><li>List（列表）<br>List（列表） 是 Python 中使用最频繁的数据类型。</li></ul><p>列表可以完成大多数集合类的数据结构实现。列表中元素的类型可以不相同，它支持数字，字符串甚至可以包含列表（所谓嵌套）。</p><p>列表是写在方括号([])之间、用逗号分隔开的元素列表。</p><p>和字符串一样，列表同样可以被索引和截取，列表被截取后返回一个包含所需元素的新列表。</p><p>列表截取的语法格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量[头下标:尾下标]</span><br></pre></td></tr></table></figure></p><p>索引值以 0 为开始值，-1 为从末尾的开始位置。</p><p>加号（+）是列表连接运算符，星号（*）是重复操作。如下实例：</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"> </span><br><span class="line">list = [ &apos;abcd&apos;, 786 , 2.23, &apos;xiaoer&apos;, 70.2 ]</span><br><span class="line">tinylist = [123, &apos;xiaoer&apos;]</span><br><span class="line"> </span><br><span class="line">print (list)            # 输出完整列表</span><br><span class="line">print (list[0])         # 输出列表第一个元素</span><br><span class="line">print (list[1:3])       # 从第二个开始输出到第三个元素</span><br><span class="line">print (list[2:])        # 输出从第三个元素开始的所有元素</span><br><span class="line">print (tinylist * 2)    # 输出两次列表</span><br><span class="line">print (list + tinylist) # 连接列表</span><br></pre></td></tr></table></figure></p><p>以上实例输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[&apos;abcd&apos;, 786, 2.23, &apos;xiaoer&apos;, 70.2]</span><br><span class="line">abcd</span><br><span class="line">[786, 2.23]</span><br><span class="line">[2.23, &apos;xiaoer&apos;, 70.2]</span><br><span class="line">[123, &apos;xiaoer&apos;, 123, &apos;xiaoer&apos;]</span><br><span class="line">[&apos;abcd&apos;, 786, 2.23, &apos;xiaoer&apos;, 70.2, 123, &apos;xiaoer&apos;]</span><br></pre></td></tr></table></figure></p><p>与Python字符串不一样的是，列表中的元素是可以改变的：</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a = [1, 2, 3, 4, 5, 6]</span><br><span class="line">&gt;&gt;&gt; a[0] = 9</span><br><span class="line">&gt;&gt;&gt; a[2:5] = [13, 14, 15]</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">[9, 2, 13, 14, 15, 6]</span><br><span class="line">&gt;&gt;&gt; a[2:5] = []   # 将对应的元素值设置为 [] </span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">[9, 2, 6]</span><br></pre></td></tr></table></figure></p><p>List内置了有很多方法，例如append()、pop()等等。</p><p>注意：</p><p>1、List写在方括号之间，元素用逗号隔开。<br>2、和字符串一样，list可以被索引和切片。<br>3、List可以使用+操作符进行拼接。<br>4、List中的元素是可以改变的。</p><ul><li>元祖<br>元组（tuple）与列表类似，不同之处在于元组的元素不能修改。元组写在小括号 () 里，元素之间用逗号隔开。</li></ul><p>元组中的元素类型也可以不相同：</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"> </span><br><span class="line">tuple = ( &apos;abcd&apos;, 786 , 2.23, &apos;xiaoer&apos;, 70.2  )</span><br><span class="line">tinytuple = (123, &apos;xiaoer&apos;)</span><br><span class="line"> </span><br><span class="line">print (tuple)             # 输出完整元组</span><br><span class="line">print (tuple[0])          # 输出元组的第一个元素</span><br><span class="line">print (tuple[1:3])        # 输出从第二个元素开始到第三个元素</span><br><span class="line">print (tuple[2:])         # 输出从第三个元素开始的所有元素</span><br><span class="line">print (tinytuple * 2)     # 输出两次元组</span><br><span class="line">print (tuple + tinytuple) # 连接元组</span><br></pre></td></tr></table></figure></p><p>以上实例输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(&apos;abcd&apos;, 786, 2.23, &apos;xiaoer&apos;, 70.2)</span><br><span class="line">abcd</span><br><span class="line">(786, 2.23)</span><br><span class="line">(2.23, &apos;xiaoer&apos;, 70.2)</span><br><span class="line">(123, &apos;xiaoer&apos;, 123, &apos;xiaoer&apos;)</span><br><span class="line">(&apos;abcd&apos;, 786, 2.23, &apos;xiaoer&apos;, 70.2, 123, &apos;xiaoer&apos;)</span><br></pre></td></tr></table></figure></p><p>元组与字符串类似，可以被索引且下标索引从0开始，-1 为从末尾开始的位置。也可以进行截取（看上面，这里不再赘述）。</p><p>其实，可以把字符串看作一种特殊的元组。</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;tup = (1, 2, 3, 4, 5, 6)</span><br><span class="line">&gt;&gt;&gt; print(tup[0])</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; print(tup[1:5])</span><br><span class="line">(2, 3, 4, 5)</span><br><span class="line">&gt;&gt;&gt; tup[0] = 11  # 修改元组元素的操作是非法的</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">TypeError: &apos;tuple&apos; object does not support item assignment</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></p><p>虽然tuple的元素不可改变，但它可以包含可变的对象，比如list列表。</p><p>构造包含 0 个或 1 个元素的元组比较特殊，所以有一些额外的语法规则：</p><p>tup1 = ()    # 空元组<br>tup2 = (20,) # 一个元素，需要在元素后添加逗号<br>string、list和tuple都属于sequence（序列）。</p><p>注意：</p><p>1、与字符串一样，元组的元素不能修改。<br>2、元组也可以被索引和切片，方法一样。<br>3、注意构造包含0或1个元素的元组的特殊语法规则。<br>4、元组也可以使用+操作符进行拼接。</p><ul><li>Set（集合）<br>集合（set）是一个无序不重复元素的序列。</li></ul><p>基本功能是进行成员关系测试和删除重复元素。</p><p>可以使用大括号 { } 或者 set() 函数创建集合，注意：创建一个空集合必须用 set() 而不是 { }，因为 { } 是用来创建一个空字典。</p><p>创建格式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parame = &#123;value01,value02,...&#125;</span><br></pre></td></tr></table></figure></p><p>或者<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set(value)</span><br></pre></td></tr></table></figure></p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"> </span><br><span class="line">student = &#123;&apos;Tom&apos;, &apos;Jim&apos;, &apos;Mary&apos;, &apos;Tom&apos;, &apos;Jack&apos;, &apos;Rose&apos;&#125;</span><br><span class="line"> </span><br><span class="line">print(student)   # 输出集合，重复的元素被自动去掉</span><br><span class="line"> </span><br><span class="line"># 成员测试</span><br><span class="line">if(&apos;Rose&apos; in student) :</span><br><span class="line">    print(&apos;Rose 在集合中&apos;)</span><br><span class="line">else :</span><br><span class="line">    print(&apos;Rose 不在集合中&apos;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># set可以进行集合运算</span><br><span class="line">a = set(&apos;abracadabra&apos;)</span><br><span class="line">b = set(&apos;alacazam&apos;)</span><br><span class="line"> </span><br><span class="line">print(a)</span><br><span class="line"> </span><br><span class="line">print(a - b)     # a和b的差集</span><br><span class="line"> </span><br><span class="line">print(a | b)     # a和b的并集</span><br><span class="line"> </span><br><span class="line">print(a &amp; b)     # a和b的交集</span><br><span class="line"> </span><br><span class="line">print(a ^ b)     # a和b中不同时存在的元素</span><br></pre></td></tr></table></figure></p><p>以上实例输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;Mary&apos;, &apos;Jim&apos;, &apos;Rose&apos;, &apos;Jack&apos;, &apos;Tom&apos;&#125;</span><br><span class="line">Rose 在集合中</span><br><span class="line">&#123;&apos;b&apos;, &apos;a&apos;, &apos;c&apos;, &apos;r&apos;, &apos;d&apos;&#125;</span><br><span class="line">&#123;&apos;b&apos;, &apos;d&apos;, &apos;r&apos;&#125;</span><br><span class="line">&#123;&apos;l&apos;, &apos;r&apos;, &apos;a&apos;, &apos;c&apos;, &apos;z&apos;, &apos;m&apos;, &apos;b&apos;, &apos;d&apos;&#125;</span><br><span class="line">&#123;&apos;a&apos;, &apos;c&apos;&#125;</span><br><span class="line">&#123;&apos;l&apos;, &apos;r&apos;, &apos;z&apos;, &apos;m&apos;, &apos;b&apos;, &apos;d&apos;&#125;</span><br></pre></td></tr></table></figure></p><ul><li>Dictionary（字典）<br>字典（dictionary）是Python中另一个非常有用的内置数据类型。</li></ul><p>列表是有序的对象集合，字典是无序的对象集合。两者之间的区别在于：字典当中的元素是通过键来存取的，而不是通过偏移存取。</p><p>字典是一种映射类型，字典用”{ }”标识，它是一个无序的键(key) : 值(value)对集合。</p><p>键(key)必须使用不可变类型。</p><p>在同一个字典中，键(key)必须是唯一的。</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"> </span><br><span class="line">dict = &#123;&#125;</span><br><span class="line">dict[&apos;one&apos;] = &quot;1 - 小二客栈&quot;</span><br><span class="line">dict[2]     = &quot;2 - 小二最牛&quot;</span><br><span class="line"> </span><br><span class="line">tinydict = &#123;&apos;name&apos;: &apos;runoob&apos;,&apos;code&apos;:1, &apos;site&apos;: &apos;www.runoob.com&apos;&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">print (dict[&apos;one&apos;])       # 输出键为 &apos;one&apos; 的值</span><br><span class="line">print (dict[2])           # 输出键为 2 的值</span><br><span class="line">print (tinydict)          # 输出完整的字典</span><br><span class="line">print (tinydict.keys())   # 输出所有键</span><br><span class="line">print (tinydict.values()) # 输出所有值</span><br></pre></td></tr></table></figure></p><p>以上实例输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 - 小二客栈</span><br><span class="line">2 - 小二最牛</span><br><span class="line">&#123;&apos;name&apos;: &apos;runoob&apos;, &apos;site&apos;: &apos;www.runoob.com&apos;, &apos;code&apos;: 1&#125;</span><br><span class="line">dict_keys([&apos;name&apos;, &apos;site&apos;, &apos;code&apos;])</span><br><span class="line">dict_values([&apos;runoob&apos;, &apos;www.runoob.com&apos;, 1])</span><br></pre></td></tr></table></figure></p><p>构造函数 dict() 可以直接从键值对序列中构建字典如下：</p><p>实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;dict([(&apos;xiaoer&apos;, 1), (&apos;Google&apos;, 2), (&apos;Taobao&apos;, 3)])</span><br><span class="line">&#123;&apos;Taobao&apos;: 3, &apos;xiaoer&apos;: 1, &apos;Google&apos;: 2&#125;</span><br><span class="line"> </span><br><span class="line">&gt;&gt;&gt; &#123;x: x**2 for x in (2, 4, 6)&#125;</span><br><span class="line">&#123;2: 4, 4: 16, 6: 36&#125;</span><br><span class="line"> </span><br><span class="line">&gt;&gt;&gt; dict(xiaoer=1, Google=2, Taobao=3)</span><br><span class="line">&#123;&apos;Taobao&apos;: 3, &apos;xiaoer&apos;: 1, &apos;Google&apos;: 2&#125;</span><br></pre></td></tr></table></figure></p><p>另外，字典类型也有一些内置的函数，例如clear()、keys()、values()等。</p><p>注意：</p><p>1、字典是一种映射类型，它的元素是键值对。<br>2、字典的关键字必须为不可变类型，且不能重复。<br>3、创建空字典使用 { }。</p><ul><li>Python数据类型转换<br>有时候，我们需要对数据内置的类型进行转换，数据类型的转换，你只需要将数据类型作为函数名即可。</li></ul><p>以下几个内置的函数可以执行数据类型之间的转换。这些函数返回一个新的对象，表示转换的值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">函数描述</span><br><span class="line">int(x [,base])</span><br><span class="line"></span><br><span class="line">将x转换为一个整数</span><br><span class="line"></span><br><span class="line">float(x)</span><br><span class="line"></span><br><span class="line">将x转换到一个浮点数</span><br><span class="line"></span><br><span class="line">complex(real [,imag])</span><br><span class="line"></span><br><span class="line">创建一个复数</span><br><span class="line"></span><br><span class="line">str(x)</span><br><span class="line"></span><br><span class="line">将对象 x 转换为字符串</span><br><span class="line"></span><br><span class="line">repr(x)</span><br><span class="line"></span><br><span class="line">将对象 x 转换为表达式字符串</span><br><span class="line"></span><br><span class="line">eval(str)</span><br><span class="line"></span><br><span class="line">用来计算在字符串中的有效Python表达式,并返回一个对象</span><br><span class="line"></span><br><span class="line">tuple(s)</span><br><span class="line"></span><br><span class="line">将序列 s 转换为一个元组</span><br><span class="line"></span><br><span class="line">list(s)</span><br><span class="line"></span><br><span class="line">将序列 s 转换为一个列表</span><br><span class="line"></span><br><span class="line">set(s)</span><br><span class="line"></span><br><span class="line">转换为可变集合</span><br><span class="line"></span><br><span class="line">dict(d)</span><br><span class="line"></span><br><span class="line">创建一个字典。d 必须是一个序列 (key,value)元组。</span><br><span class="line"></span><br><span class="line">frozenset(s)</span><br><span class="line"></span><br><span class="line">转换为不可变集合</span><br><span class="line"></span><br><span class="line">chr(x)</span><br><span class="line"></span><br><span class="line">将一个整数转换为一个字符</span><br><span class="line"></span><br><span class="line">ord(x)</span><br><span class="line"></span><br><span class="line">将一个字符转换为它的整数值</span><br><span class="line"></span><br><span class="line">hex(x)</span><br><span class="line"></span><br><span class="line">将一个整数转换为一个十六进制字符串</span><br><span class="line"></span><br><span class="line">oct(x)</span><br><span class="line"></span><br><span class="line">将一个整数转换为一个八进制字符串</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;** Python 中的变量不需要声明。每个变量在使用前都必须赋值，变量赋值以后该变量才会被创建。&lt;br&gt;在 Python 中，变量就是变量，它没有类型，我们所说的”类型”是变量所指的内存中对象的类型。&lt;/p&gt;
&lt;p&gt;等号（=）用来给变量赋值。&lt;/p&gt;
&lt;p&gt;等号（=）运算
      
    
    </summary>
    
    
      <category term="Python" scheme="http://www.wenchong.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Python基础语法</title>
    <link href="http://www.wenchong.top/2018/05/16/Python%E5%AD%A6%E4%B9%A0%EF%BC%881%EF%BC%89%E2%80%94%E2%80%94%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
    <id>http://www.wenchong.top/2018/05/16/Python学习（1）——基础语法/</id>
    <published>2018-05-16T07:49:50.720Z</published>
    <updated>2018-05-16T08:20:05.723Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>编码<br>Python3源码文件以UTF-8编码，所有字符串都是Unicode字符串。</p></li><li><p>标识符<br>第一个字符必须是字母表中字母或下划线_。<br>标识符的其他部分有字母、数字和下划线组成。<br>标识符对大小写敏感。</p></li><li><p>Python保留字<br>保留字即关键字。不能把它们用作任何标识符名称。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; keyword.kwlist</span><br><span class="line">[&apos;False&apos;, &apos;None&apos;, &apos;True&apos;, &apos;and&apos;, &apos;as&apos;, &apos;assert&apos;, &apos;break&apos;, &apos;class&apos;, &apos;continue&apos;, &apos;def&apos;, &apos;del&apos;, &apos;elif&apos;, &apos;else&apos;, &apos;except&apos;, &apos;finally&apos;, &apos;for&apos;, &apos;from&apos;, &apos;global&apos;, &apos;if&apos;, &apos;import&apos;, &apos;in&apos;, &apos;is&apos;, &apos;lambda&apos;, &apos;nonlocal&apos;, &apos;not&apos;, &apos;or&apos;, &apos;pass&apos;, &apos;raise&apos;, &apos;return&apos;, &apos;try&apos;, &apos;while&apos;, &apos;with&apos;, &apos;yield&apos;]</span><br></pre></td></tr></table></figure></li><li><p>注释<br>Python中单行注释以#开头<br>多行注释可以用多个#或者’’’和”””:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line"># 第一个注释</span><br><span class="line"># 第二个注释</span><br><span class="line"></span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">第三注释</span><br><span class="line">第四注释</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">第五注释</span><br><span class="line">第六注释</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></li><li><p>行与缩进<br>Python最具特色的就是使用缩进来表示代码块。<br>缩进的空格数是可变的，但是同一个代码块语句biubiu包含相同的缩进空格数。例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if True:</span><br><span class="line">    print (&quot;True&quot;)</span><br><span class="line">else:</span><br><span class="line">    print (&quot;False&quot;)</span><br></pre></td></tr></table></figure></li></ul><p>** 缩进不一致，会导致运行错误。错误类型如下：<br>IndentationError: unindent does not match any outer indentation level</p><ul><li>多行语句<br>Python通常是一行写完一条语句，但如果语句很长，我们可以使用反斜杠（\）来实现多行语句，例如：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">total = item_one + \</span><br><span class="line">        item_two + \</span><br><span class="line">        item_three</span><br></pre></td></tr></table></figure></li></ul><p>** 在 [], {}, 或 () 中的多行语句，不需要使用反斜杠()。</p><ul><li><p>数字类型<br>Python中有是四种类型：整数、布尔型、浮点数和复数。<br>int 整数<br>bool 布尔<br>float 浮点数<br>complex 复数</p></li><li><p>字符串<br>Python中单引号和双引号使用完全相同。<br>使用三引号可以指定一个多行字符串。<br>转义符’\’<br>反斜杠可以用来转义，但r可以让反斜杠不发生转义。如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r&quot;this is a line with \n&quot; 则\n会显示，并不是换行。</span><br></pre></td></tr></table></figure></li></ul><p>按字面意义级联字符串，如”this””is””string”会被自动转换成this id string。<br>字符串可以用+运算符连接诶在一起，用*运算符重复。<br>Python中的字符串有两种索引方式，从左往右以0开始，从右往左以-1开始。<br>Python中的字符串不能改变。<br>Python没有单独的字符类型，一个字符就是长度为1的字符串。<br>字符串的截取的语法格式如下：变量[头下标:尾下标]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">word = &apos;字符串&apos;</span><br><span class="line">sentence = &quot;这是一个句子。&quot;</span><br><span class="line">paragraph = &quot;&quot;&quot;这是一个段落，</span><br><span class="line">可以由多行组成&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></p><p>实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line">str=&apos;Runoob&apos;</span><br><span class="line"></span><br><span class="line">print(str)                 # 输出字符串</span><br><span class="line">print(str[0:-1])           # 输出第一个到倒数第二个的所有字符</span><br><span class="line">print(str[0])              # 输出字符串第一个字符</span><br><span class="line">print(str[2:5])            # 输出从第三个开始到第五个的字符</span><br><span class="line">print(str[2:])             # 输出从第三个开始的后的所有字符</span><br><span class="line">print(str * 2)             # 输出字符串两次</span><br><span class="line">print(str + &apos;你好&apos;)        # 连接字符串</span><br><span class="line"></span><br><span class="line">print(&apos;------------------------------&apos;)</span><br><span class="line"></span><br><span class="line">print(&apos;hello\nrunoob&apos;)      # 使用反斜杠(\)+n转义特殊字符</span><br><span class="line">print(r&apos;hello\nrunoob&apos;)     # 在字符串前面添加一个 r，表示原始字符串，不会发生转义</span><br><span class="line">输出结果为：</span><br><span class="line"></span><br><span class="line">Runoob</span><br><span class="line">Runoo</span><br><span class="line">R</span><br><span class="line">noo</span><br><span class="line">noob</span><br><span class="line">RunoobRunoob</span><br><span class="line">Runoob你好</span><br><span class="line">------------------------------</span><br><span class="line">hello</span><br><span class="line">runoob</span><br><span class="line">hello\nrunoob</span><br></pre></td></tr></table></figure></p><ul><li>空行<br>函数、类的方法之间有空行分隔。</li></ul><p>*等待用户输入<br>执行下面的程序在按回车键后就会等待用户输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line">input(&quot;\n\n按下 enter 键后退出。&quot;)</span><br></pre></td></tr></table></figure></p><p>以上代码中 ，”\n\n”在结果输出前会输出两个新的空行。一旦用户按下 enter 键时，程序将退出。</p><ul><li><p>同一行显示多条语句<br>Python可以在同一行中使用多条语句，语句之间使用分号(;)分割，以下是一个简单的实例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line">import sys; x = &apos;小二&apos;; sys.stdout.write(x + &apos;\n&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">执行以上代码，输出结果为：</span><br><span class="line"></span><br><span class="line">小二</span><br></pre></td></tr></table></figure></li><li><p>多个语句构成代码组<br>缩进相同的一组语句构成一个代码块，我们称之代码组。</p></li></ul><p>像if、while、def和class这样的复合语句，首行以关键字开始，以冒号( : )结束，该行之后的一行或多行代码构成代码组。</p><p>我们将首行及后面的代码组称为一个子句(clause)。</p><p>如下实例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if expression : </span><br><span class="line">   suite</span><br><span class="line">elif expression : </span><br><span class="line">   suite </span><br><span class="line">else : </span><br><span class="line">   suite</span><br></pre></td></tr></table></figure></p><ul><li><p>print输出<br>print 默认输出是换行的，如果要实现不换行需要在变量末尾加上 end=””：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line">x=&quot;a&quot;</span><br><span class="line">y=&quot;b&quot;</span><br><span class="line"># 换行输出</span><br><span class="line">print( x )</span><br><span class="line">print( y )</span><br><span class="line"></span><br><span class="line">print(&apos;---------&apos;)</span><br><span class="line"># 不换行输出</span><br><span class="line">print( x, end=&quot; &quot; )</span><br><span class="line">print( y, end=&quot; &quot; )</span><br><span class="line">print()</span><br><span class="line">以上实例执行结果为：</span><br><span class="line"></span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">---------</span><br><span class="line">a b</span><br></pre></td></tr></table></figure></li><li><p>import 与 from…import<br>在 python 用 import 或者 from…import 来导入相应的模块。</p></li></ul><p>将整个模块(somemodule)导入，格式为： import somemodule</p><p>从某个模块中导入某个函数,格式为： from somemodule import somefunction</p><p>从某个模块中导入多个函数,格式为： from somemodule import firstfunc, secondfunc, thirdfunc</p><p>将某个模块中的全部函数导入，格式为： from somemodule import *</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">导入 sys 模块</span><br><span class="line">import sys</span><br><span class="line">print(&apos;================Python import mode==========================&apos;);</span><br><span class="line">print (&apos;命令行参数为:&apos;)</span><br><span class="line">for i in sys.argv:</span><br><span class="line">    print (i)</span><br><span class="line">print (&apos;\n python 路径为&apos;,sys.path)</span><br><span class="line">导入 sys 模块的 argv,path 成员</span><br><span class="line">from sys import argv,path  #  导入特定的成员</span><br><span class="line"> </span><br><span class="line">print(&apos;================python from import===================================&apos;)</span><br><span class="line">print(&apos;path:&apos;,path) # 因为已经导入path成员，所以此处引用时不需要加sys.path</span><br></pre></td></tr></table></figure><ul><li>命令行参数<br>很多程序可以执行一些操作来查看一些基本信息，Python可以使用-h参数查看各参数帮助信息：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ python -h</span><br><span class="line">usage: python [option] ... [-c cmd | -m mod | file | -] [arg] ...</span><br><span class="line">Options and arguments (and corresponding environment variables):</span><br><span class="line">-c cmd : program passed in as string (terminates option list)</span><br><span class="line">-d     : debug output from parser (also PYTHONDEBUG=x)</span><br><span class="line">-E     : ignore environment variables (such as PYTHONPATH)</span><br><span class="line">-h     : print this help message and exit</span><br><span class="line"></span><br><span class="line">[ etc. ]</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;&lt;p&gt;编码&lt;br&gt;Python3源码文件以UTF-8编码，所有字符串都是Unicode字符串。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;标识符&lt;br&gt;第一个字符必须是字母表中字母或下划线_。&lt;br&gt;标识符的其他部分有字母、数字和下划线组成。&lt;br&gt;标识符对大小写敏感。
      
    
    </summary>
    
    
      <category term="Python" scheme="http://www.wenchong.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Linux常用命令</title>
    <link href="http://www.wenchong.top/2018/05/14/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>http://www.wenchong.top/2018/05/14/Linux常用命令/</id>
    <published>2018-05-14T03:08:03.323Z</published>
    <updated>2018-05-14T06:16:03.670Z</updated>
    
    <content type="html"><![CDATA[<p>** 使用Linux时，会有大量的命令，而一般常用的命令并不是很多（当然Linux系统管理员除外）。<br>1.cd命令<br>这是一个非常基本，也是大家经常需要使用的命令，它用于切换当前目录，它的参数是要切换到的目录的路径，可以是绝对路径，也可以是相对路径。如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /root/Docements # 切换到目录/root/Docements  </span><br><span class="line">cd ./path          # 切换到当前目录下的path目录中，“.”表示当前目录    </span><br><span class="line">cd ../path         # 切换到上层目录中的path目录中，“..”表示上一层目录</span><br></pre></td></tr></table></figure></p><p>2、ls命令<br>这是一个非常有用的查看文件与目录的命令，list之意，它的参数非常多，下面就列出一些我常用的参数吧，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-l ：列出长数据串，包含文件的属性与权限数据等  </span><br><span class="line">-a ：列出全部的文件，连同隐藏文件（开头为.的文件）一起列出来（常用）  </span><br><span class="line">-d ：仅列出目录本身，而不是列出目录的文件数据  </span><br><span class="line">-h ：将文件容量以较易读的方式（GB，kB等）列出来  </span><br><span class="line">-R ：连同子目录的内容一起列出（递归列出），等于该目录下的所有文件都会显示出来  </span><br><span class="line">注：这些参数也可以组合使用，下面举两个例子：</span><br><span class="line"></span><br><span class="line">ls -l #以长数据串的形式列出当前目录下的数据文件和目录  </span><br><span class="line">ls -lR #以长数据串的形式列出当前目录下的所有文件</span><br></pre></td></tr></table></figure></p><p>3、grep命令<br>该命令常用于分析一行的信息，若当中有我们所需要的信息，就将该行显示出来，该命令通常与管道命令一起使用，用于对一些命令的输出进行筛选加工等等，它的简单语法为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grep [-acinv] [--color=auto] &apos;查找字符串&apos; filename  </span><br><span class="line">它的常用参数如下：</span><br><span class="line"></span><br><span class="line">-a ：将binary文件以text文件的方式查找数据  </span><br><span class="line">-c ：计算找到‘查找字符串’的次数  </span><br><span class="line">-i ：忽略大小写的区别，即把大小写视为相同  </span><br><span class="line">-v ：反向选择，即显示出没有‘查找字符串’内容的那一行  </span><br><span class="line"># 例如：  </span><br><span class="line"># 取出文件/etc/man.config中包含MANPATH的行，并把找到的关键字加上颜色  </span><br><span class="line">grep --color=auto &apos;MANPATH&apos; /etc/man.config  </span><br><span class="line"># 把ls -l的输出中包含字母file（不区分大小写）的内容输出  </span><br><span class="line">ls -l | grep -i file</span><br></pre></td></tr></table></figure></p><p>4、find命令<br>find是一个基于查找的功能非常强大的命令，相对而言，它的使用也相对较为复杂，参数也比较多，所以在这里将给把它们分类列出，它的基本语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">find [PATH] [option] [action]  </span><br><span class="line">  </span><br><span class="line">** 与时间有关的参数：  </span><br><span class="line">-mtime n : n为数字，意思为在n天之前的“一天内”被更改过的文件；  </span><br><span class="line">-mtime +n : 列出在n天之前（不含n天本身）被更改过的文件名；  </span><br><span class="line">-mtime -n : 列出在n天之内（含n天本身）被更改过的文件名；  </span><br><span class="line">-newer file : 列出比file还要新的文件名  </span><br><span class="line"># 例如：  </span><br><span class="line">find /root -mtime 0 # 在当前目录下查找今天之内有改动的文件</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">与用户或用户组名有关的参数：  </span><br><span class="line">-user name : 列出文件所有者为name的文件  </span><br><span class="line">-group name : 列出文件所属用户组为name的文件  </span><br><span class="line">-uid n : 列出文件所有者为用户ID为n的文件  </span><br><span class="line">-gid n : 列出文件所属用户组为用户组ID为n的文件  </span><br><span class="line"># 例如：  </span><br><span class="line">find /home/ljianhui -user ljianhui # 在目录/home/ljianhui中找出所有者为ljianhui的文件</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 与文件权限及名称有关的参数：  </span><br><span class="line">-name filename ：找出文件名为filename的文件  </span><br><span class="line">-size [+-]SIZE ：找出比SIZE还要大（+）或小（-）的文件  </span><br><span class="line">-tpye TYPE ：查找文件的类型为TYPE的文件，TYPE的值主要有：一般文件（f)、设备文件（b、c）、  </span><br><span class="line">             目录（d）、连接文件（l）、socket（s）、FIFO管道文件（p）；  </span><br><span class="line">-perm mode ：查找文件权限刚好等于mode的文件，mode用数字表示，如0755；  </span><br><span class="line">-perm -mode ：查找文件权限必须要全部包括mode权限的文件，mode用数字表示  </span><br><span class="line">-perm +mode ：查找文件权限包含任一mode的权限的文件，mode用数字表示  </span><br><span class="line"># 例如：  </span><br><span class="line">find / -name passwd # 查找文件名为passwd的文件  </span><br><span class="line">find . -perm 0755 # 查找当前目录中文件权限的0755的文件  </span><br><span class="line">find . -size +12k # 查找当前目录中大于12KB的文件，注意c表示byte</span><br></pre></td></tr></table></figure><p>5、cp命令<br>该命令用于复制文件，copy之意，它还可以把多个文件一次性地复制到一个目录下，它的常用参数如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-a ：将文件的特性一起复制  </span><br><span class="line">-p ：连同文件的属性一起复制，而非使用默认方式，与-a相似，常用于备份  </span><br><span class="line">-i ：若目标文件已经存在时，在覆盖时会先询问操作的进行  </span><br><span class="line">-r ：递归持续复制，用于目录的复制行为  </span><br><span class="line">-u ：目标文件与源文件有差异时才会复制  </span><br><span class="line">例如 ：</span><br><span class="line"></span><br><span class="line">cp -a file1 file2 #连同文件的所有特性把文件file1复制成文件file2  </span><br><span class="line">cp file1 file2 file3 dir #把文件file1、file2、file3复制到目录dir中</span><br></pre></td></tr></table></figure></p><p>6、mv命令<br>该命令用于移动文件、目录或更名，move之意，它的常用参数如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-f ：force强制的意思，如果目标文件已经存在，不会询问而直接覆盖  </span><br><span class="line">-i ：若目标文件已经存在，就会询问是否覆盖  </span><br><span class="line">-u ：若目标文件已经存在，且比目标文件新，才会更新  </span><br><span class="line">注：该命令可以把一个文件或多个文件一次移动一个文件夹中，但是最后一个目标文件一定要是“目录”。</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">[plain] view plain copy</span><br><span class="line">mv file1 file2 file3 dir # 把文件file1、file2、file3移动到目录dir中  </span><br><span class="line">mv file1 file2 # 把文件file1重命名为file2</span><br></pre></td></tr></table></figure></p><p>7、rm命令<br>该命令用于删除文件或目录，remove之间，它的常用参数如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-f ：就是force的意思，忽略不存在的文件，不会出现警告消息  </span><br><span class="line">-i ：互动模式，在删除前会询问用户是否操作  </span><br><span class="line">-r ：递归删除，最常用于目录删除，它是一个非常危险的参数  </span><br><span class="line">例如：</span><br><span class="line">[plain] view plain copy</span><br><span class="line">rm -i file # 删除文件file，在删除之前会询问是否进行该操作  </span><br><span class="line">rm -fr dir # 强制删除目录dir中的所有文件 </span><br><span class="line">``` </span><br><span class="line">8、ps命令</span><br><span class="line">该命令用于将某个时间点的进程运行情况选取下来并输出，process之意，它的常用参数如下：</span><br></pre></td></tr></table></figure></p><p>-A ：所有的进程均显示出来<br>-a ：不与terminal有关的所有进程<br>-u ：有效用户的相关进程<br>-x ：一般与a参数一起使用，可列出较完整的信息<br>-l ：较长，较详细地将PID的信息列出<br>其实我们只要记住ps一般使用的命令参数搭配即可，它们并不多，如下：<br>[plain] view plain copy<br>ps aux # 查看系统所有的进程数据<br>ps ax # 查看不与terminal有关的所有进程<br>ps -lA # 查看系统所有的进程数据<br>ps axjf # 查看连同一部分进程树状态<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">9、kill命令</span><br><span class="line">该命令用于向某个工作（%jobnumber）或者是某个PID（数字）传送一个信号，它通常与ps和jobs命令一起使用，它的基本语法如下：</span><br></pre></td></tr></table></figure></p><p>kill -signal PID<br>signal的常用参数如下：<br>注：最前面的数字为信号的代号，使用时可以用代号代替相应的信号。<br>[plain] view plain copy<br>1：SIGHUP，启动被终止的进程<br>2：SIGINT，相当于输入ctrl+c，中断一个程序的进行<br>9：SIGKILL，强制中断一个进程的进行<br>15：SIGTERM，以正常的结束进程方式来终止进程<br>17：SIGSTOP，相当于输入ctrl+z，暂停一个进程的进行<br>例如：<br>[plain] view plain copy</p><h1 id="以正常的结束进程方式来终于第一个后台工作，可用jobs命令查看后台中的第一个工作进程"><a href="#以正常的结束进程方式来终于第一个后台工作，可用jobs命令查看后台中的第一个工作进程" class="headerlink" title="以正常的结束进程方式来终于第一个后台工作，可用jobs命令查看后台中的第一个工作进程"></a>以正常的结束进程方式来终于第一个后台工作，可用jobs命令查看后台中的第一个工作进程</h1><p>kill -SIGTERM %1   </p><h1 id="重新改动进程ID为PID的进程，PID可用ps命令通过管道命令加上grep命令进行筛选获得"><a href="#重新改动进程ID为PID的进程，PID可用ps命令通过管道命令加上grep命令进行筛选获得" class="headerlink" title="重新改动进程ID为PID的进程，PID可用ps命令通过管道命令加上grep命令进行筛选获得"></a>重新改动进程ID为PID的进程，PID可用ps命令通过管道命令加上grep命令进行筛选获得</h1><p>kill -SIGHUP PID<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10、killall命令</span><br><span class="line">该命令用于向一个命令启动的进程发送一个信号，它的一般语法如下：</span><br></pre></td></tr></table></figure></p><p>killall [-iIe] [command name]<br>它的参数如下：<br>[plain] view plain copy<br>-i ：交互式的意思，若需要删除时，会询问用户<br>-e ：表示后面接的command name要一致，但command name不能超过15个字符<br>-I ：命令名称忽略大小写  </p><h1 id="例如："><a href="#例如：" class="headerlink" title="例如："></a>例如：</h1><p>killall -SIGHUP syslogd # 重新启动syslogd<br>11、file命令<br>该命令用于判断接在file命令后的文件的基本数据，因为在Linux下文件的类型并不是以后缀为分的，所以这个命令对我们来说就很有用了，它的用法非常简单，基本语法如下：<br>[plain] view plain copy<br>file filename  </p><p>#例如：<br>file ./test<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">12、tar命令</span><br><span class="line">该命令用于对文件进行打包，默认情况并不会压缩，如果指定了相应的参数，它还会调用相应的压缩程序（如gzip和bzip等）进行压缩和解压。它的常用参数如下：</span><br></pre></td></tr></table></figure></p><p>-c ：新建打包文件<br>-t ：查看打包文件的内容含有哪些文件名<br>-x ：解打包或解压缩的功能，可以搭配-C（大写）指定解压的目录，注意-c,-t,-x不能同时出现在同一条命令中<br>-j ：通过bzip2的支持进行压缩/解压缩<br>-z ：通过gzip的支持进行压缩/解压缩<br>-v ：在压缩/解压缩过程中，将正在处理的文件名显示出来<br>-f filename ：filename为要处理的文件<br>-C dir ：指定压缩/解压缩的目录dir<br>上面的解说可以已经让你晕过去了，但是通常我们只需要记住下面三条命令即可：<br>[plain] view plain copy<br>压缩：tar -jcv -f filename.tar.bz2 要被处理的文件或目录名称<br>查询：tar -jtv -f filename.tar.bz2<br>解压：tar -jxv -f filename.tar.bz2 -C 欲解压缩的目录<br>注：文件名并不定要以后缀tar.bz2结尾，这里主要是为了说明使用的压缩程序为bzip2<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">13、cat命令</span><br><span class="line">该命令用于查看文本文件的内容，后接要查看的文件名，通常可用管道与more和less一起使用，从而可以一页页地查看数据。例如：</span><br></pre></td></tr></table></figure></p><p>cat text | less # 查看text文件中的内容  </p><h1 id="注：这条命令也可以使用less-text来代替"><a href="#注：这条命令也可以使用less-text来代替" class="headerlink" title="注：这条命令也可以使用less text来代替"></a>注：这条命令也可以使用less text来代替</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">14、chgrp命令</span><br><span class="line">该命令用于改变文件所属用户组，它的使用非常简单，它的基本用法如下：</span><br></pre></td></tr></table></figure><p>chgrp [-R] dirname/filename<br>-R ：进行递归的持续对所有文件和子目录更改  </p><h1 id="例如：-1"><a href="#例如：-1" class="headerlink" title="例如："></a>例如：</h1><p>chgrp users -R ./dir # 递归地把dir目录下中的所有文件和子目录下所有文件的用户组修改为users<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">15、chown命令</span><br><span class="line">该命令用于改变文件的所有者，与chgrp命令的使用方法相同，只是修改的文件属性不同，不再详述。</span><br><span class="line"></span><br><span class="line">16、chmod命令</span><br><span class="line">该命令用于改变文件的权限，一般的用法如下：</span><br></pre></td></tr></table></figure></p><p>chmod [-R] xyz 文件或目录<br>-R：进行递归的持续更改，即连同子目录下的所有文件都会更改<br>同时，chmod还可以使用u（user）、g（group）、o（other）、a（all）和+（加入）、-（删除）、=（设置）跟rwx搭配来对文件的权限进行更改。</p><p>[plain] view plain copy</p><h1 id="例如：-2"><a href="#例如：-2" class="headerlink" title="例如："></a>例如：</h1><p>chmod 0755 file # 把file的文件权限改变为-rxwr-xr-x<br>chmod g+w file # 向file的文件权限中加入用户组可写权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">18、vim命令</span><br><span class="line">该命令主要用于文本编辑，它接一个或多个文件名作为参数，如果文件存在就打开，如果文件不存在就以该文件名创建一个文件。vim是一个非常好用的文本编辑器，它里面有很多非常好用的命令，在这里不再多说。你可以从这里下载vim常用操作的详细说明。</span><br><span class="line"></span><br><span class="line">19、gcc命令</span><br><span class="line">对于一个用Linux开发C程序的人来说，这个命令就非常重要了，它用于把C语言的源程序文件，编译成可执行程序，由于g++的很多参数跟它非常相似，所以这里只介绍gcc的参数，它的常用参数如下：</span><br></pre></td></tr></table></figure></p><p>-o ：output之意，用于指定生成一个可执行文件的文件名<br>-c ：用于把源文件生成目标文件（.o)，并阻止编译器创建一个完整的程序<br>-I ：增加编译时搜索头文件的路径<br>-L ：增加编译时搜索静态连接库的路径<br>-S ：把源文件生成汇编代码文件<br>-lm：表示标准库的目录中名为libm.a的函数库<br>-lpthread ：连接NPTL实现的线程库<br>-std= ：用于指定把使用的C语言的版本  </p><h1 id="例如：-3"><a href="#例如：-3" class="headerlink" title="例如："></a>例如：</h1><h1 id="把源文件test-c按照c99标准编译成可执行程序test"><a href="#把源文件test-c按照c99标准编译成可执行程序test" class="headerlink" title="把源文件test.c按照c99标准编译成可执行程序test"></a>把源文件test.c按照c99标准编译成可执行程序test</h1><p>gcc -o test test.c -lm -std=c99  </p><p>#把源文件test.c转换为相应的汇编程序源文件test.s<br>gcc -S test.c<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">20、time命令</span><br><span class="line">该命令用于测算一个命令（即程序）的执行时间。它的使用非常简单，就像平时输入命令一样，不过在命令的前面加入一个time即可，例如：</span><br></pre></td></tr></table></figure></p><p>time ./process<br>time ps aux<br>在程序或命令运行结束后，在最后输出了三个时间，它们分别是：<br>user：用户CPU时间，命令执行完成花费的用户CPU时间，即命令在用户态中执行时间总和；<br>system：系统CPU时间，命令执行完成花费的系统CPU时间，即命令在核心态中执行时间总和；<br>real：实际时间，从command命令行开始执行到运行终止的消逝时间；<br>```<br>注：用户CPU时间和系统CPU时间之和为CPU时间，即命令占用CPU执行的时间总和。实际时间要大于CPU时间，因为Linux是多任务操作系统，往往在执行一条命令时，系统还要处理其它任务。另一个需要注意的问题是即使每次执行相同命令，但所花费的时间也是不一样，其花费时间是与系统运行相关的。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;** 使用Linux时，会有大量的命令，而一般常用的命令并不是很多（当然Linux系统管理员除外）。&lt;br&gt;1.cd命令&lt;br&gt;这是一个非常基本，也是大家经常需要使用的命令，它用于切换当前目录，它的参数是要切换到的目录的路径，可以是绝对路径，也可以是相对路径。如：&lt;br&gt;&lt;
      
    
    </summary>
    
      <category term="运维" scheme="http://www.wenchong.top/categories/operation/"/>
    
    
      <category term="Linux" scheme="http://www.wenchong.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>nginx安装</title>
    <link href="http://www.wenchong.top/2018/05/11/nginx%E5%AE%89%E8%A3%85/"/>
    <id>http://www.wenchong.top/2018/05/11/nginx安装/</id>
    <published>2018-05-10T16:00:00.000Z</published>
    <updated>2018-05-14T06:13:40.805Z</updated>
    
    <content type="html"><![CDATA[<p>** Nginx(“engine x”)是一款是由俄罗斯的程序设计师Igor Sysoev所开发高性能的 Web和 反向代理 服务器，也是一个 IMAP/POP3/SMTP 代理服务器。</p><p>** 在高连接并发的情况下，Nginx是Apache服务器不错的替代品。</p><h3 id="Nginx-安装"><a href="#Nginx-安装" class="headerlink" title="Nginx 安装"></a>Nginx 安装</h3><p>系统平台：CentOS release 6.6 (Final) 64位。</p><h3 id="一、安装编译工具及库文件"><a href="#一、安装编译工具及库文件" class="headerlink" title="一、安装编译工具及库文件"></a>一、安装编译工具及库文件</h3><p>yum -y install make zlib zlib-devel gcc-c++ libtool  openssl openssl-devel</p><h3 id="二、首先要安装-PCRE"><a href="#二、首先要安装-PCRE" class="headerlink" title="二、首先要安装 PCRE"></a>二、首先要安装 PCRE</h3><p>PCRE 作用是让 Nginx 支持 Rewrite 功能。</p><p>1、下载 PCRE 安装包，下载地址： <a href="http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz" target="_blank" rel="noopener">http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz</a></p><p>[root@bogon src]# wget <a href="http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz" target="_blank" rel="noopener">http://downloads.sourceforge.net/project/pcre/pcre/8.35/pcre-8.35.tar.gz</a></p><p>2、解压安装包:</p><p>[root@bogon src]# tar zxvf pcre-8.35.tar.gz<br>3、进入安装包目录</p><p>[root@bogon src]# cd pcre-8.35<br>4、编译安装 </p><p>[root@bogon pcre-8.35]# ./configure<br>[root@bogon pcre-8.35]# make &amp;&amp; make install<br>5、查看pcre版本</p><p>[root@bogon pcre-8.35]# pcre-config –version</p><h3 id="安装-Nginx"><a href="#安装-Nginx" class="headerlink" title="安装 Nginx"></a>安装 Nginx</h3><p>1、下载 Nginx，下载地址：<a href="http://nginx.org/download/nginx-1.6.2.tar.gz" target="_blank" rel="noopener">http://nginx.org/download/nginx-1.6.2.tar.gz</a></p><p>[root@bogon src]# wget <a href="http://nginx.org/download/nginx-1.6.2.tar.gz" target="_blank" rel="noopener">http://nginx.org/download/nginx-1.6.2.tar.gz</a><br>2、解压安装包</p><p>[root@bogon src]# tar zxvf nginx-1.6.2.tar.gz<br>3、进入安装包目录</p><p>[root@bogon src]# cd nginx-1.6.2<br>4、编译安装</p><p>[root@bogon nginx-1.6.2]# ./configure –prefix=/usr/local/webserver/nginx –with-http_stub_status_module –with-http_ssl_module –with-pcre=/usr/local/src/pcre-8.35<br>[root@bogon nginx-1.6.2]# make<br>[root@bogon nginx-1.6.2]# make install<br>5、查看nginx版本</p><p>[root@bogon nginx-1.6.2]# /usr/local/webserver/nginx/sbin/nginx -v</p><p>** 到此，nginx安装完成。</p><h3 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h3><p>创建 Nginx 运行使用的用户 www：</p><p>[root@bogon conf]# /usr/sbin/groupadd www<br>[root@bogon conf]# /usr/sbin/useradd -g www www<br>配置nginx.conf ，将/usr/local/webserver/nginx/conf/nginx.conf替换为以下内容</p><p>[root@bogon conf]#  cat /usr/local/webserver/nginx/conf/nginx.conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">user www www;</span><br><span class="line">worker_processes 2; #设置值和CPU核心数一致</span><br><span class="line">error_log /usr/local/webserver/nginx/logs/nginx_error.log crit; #日志位置和日志级别</span><br><span class="line">pid /usr/local/webserver/nginx/nginx.pid;</span><br><span class="line">#Specifies the value for maximum file descriptors that can be opened by this process.</span><br><span class="line">worker_rlimit_nofile 65535;</span><br><span class="line">events</span><br><span class="line">&#123;</span><br><span class="line">  use epoll;</span><br><span class="line">  worker_connections 65535;</span><br><span class="line">&#125;</span><br><span class="line">http</span><br><span class="line">&#123;</span><br><span class="line">  include mime.types;</span><br><span class="line">  default_type application/octet-stream;</span><br><span class="line">  log_format main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">               &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">               &apos;&quot;$http_user_agent&quot; $http_x_forwarded_for&apos;;</span><br><span class="line">  </span><br><span class="line">#charset gb2312;</span><br><span class="line">     </span><br><span class="line">  server_names_hash_bucket_size 128;</span><br><span class="line">  client_header_buffer_size 32k;</span><br><span class="line">  large_client_header_buffers 4 32k;</span><br><span class="line">  client_max_body_size 8m;</span><br><span class="line">     </span><br><span class="line">  sendfile on;</span><br><span class="line">  tcp_nopush on;</span><br><span class="line">  keepalive_timeout 60;</span><br><span class="line">  tcp_nodelay on;</span><br><span class="line">  fastcgi_connect_timeout 300;</span><br><span class="line">  fastcgi_send_timeout 300;</span><br><span class="line">  fastcgi_read_timeout 300;</span><br><span class="line">  fastcgi_buffer_size 64k;</span><br><span class="line">  fastcgi_buffers 4 64k;</span><br><span class="line">  fastcgi_busy_buffers_size 128k;</span><br><span class="line">  fastcgi_temp_file_write_size 128k;</span><br><span class="line">  gzip on; </span><br><span class="line">  gzip_min_length 1k;</span><br><span class="line">  gzip_buffers 4 16k;</span><br><span class="line">  gzip_http_version 1.0;</span><br><span class="line">  gzip_comp_level 2;</span><br><span class="line">  gzip_types text/plain application/x-javascript text/css application/xml;</span><br><span class="line">  gzip_vary on;</span><br><span class="line"> </span><br><span class="line">  #limit_zone crawler $binary_remote_addr 10m;</span><br><span class="line"> #下面是server虚拟主机的配置</span><br><span class="line"> server</span><br><span class="line">  &#123;</span><br><span class="line">    listen 80;#监听端口</span><br><span class="line">    server_name localhost;#域名</span><br><span class="line">    index index.html index.htm index.php;</span><br><span class="line">    root /usr/local/webserver/nginx/html;#站点目录</span><br><span class="line">      location ~ .*\.(php|php5)?$</span><br><span class="line">    &#123;</span><br><span class="line">      #fastcgi_pass unix:/tmp/php-cgi.sock;</span><br><span class="line">      fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">      fastcgi_index index.php;</span><br><span class="line">      include fastcgi.conf;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|ico)$</span><br><span class="line">    &#123;</span><br><span class="line">      expires 30d;</span><br><span class="line">#access_log off;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ .*\.(js|css)?$</span><br><span class="line">    &#123;</span><br><span class="line">      expires 15d;</span><br><span class="line">#access_log off;</span><br><span class="line">    &#125;</span><br><span class="line">    access_log off;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>检查配置文件ngnix.conf的正确性命令：</p><p>[root@bogon conf]# /usr/local/webserver/nginx/sbin/nginx -t</p><h3 id="启动-Nginx"><a href="#启动-Nginx" class="headerlink" title="启动 Nginx"></a>启动 Nginx</h3><p>Nginx 启动命令如下：</p><p>[root@bogon conf]# /usr/local/webserver/nginx/sbin/nginx</p><h3 id="访问站点"><a href="#访问站点" class="headerlink" title="访问站点"></a>访问站点</h3><p>从浏览器访问我们配置的站点ip：</p><p>** Nginx 其他命令<br>以下包含了 Nginx 常用的几个命令：</p><p>/usr/local/webserver/nginx/sbin/nginx -s reload            # 重新载入配置文件<br>/usr/local/webserver/nginx/sbin/nginx -s reopen            # 重启 Nginx<br>/usr/local/webserver/nginx/sbin/nginx -s stop              # 停止 Nginx</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;** Nginx(“engine x”)是一款是由俄罗斯的程序设计师Igor Sysoev所开发高性能的 Web和 反向代理 服务器，也是一个 IMAP/POP3/SMTP 代理服务器。&lt;/p&gt;
&lt;p&gt;** 在高连接并发的情况下，Nginx是Apache服务器不错的替代品。
      
    
    </summary>
    
      <category term="运维" scheme="http://www.wenchong.top/categories/operation/"/>
    
    
      <category term="nginx" scheme="http://www.wenchong.top/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>CDH安装</title>
    <link href="http://www.wenchong.top/2018/05/04/CDH%E6%90%AD%E5%BB%BA/"/>
    <id>http://www.wenchong.top/2018/05/04/CDH搭建/</id>
    <published>2018-05-04T01:13:27.168Z</published>
    <updated>2018-05-21T07:11:05.465Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、准备"><a href="#一、准备" class="headerlink" title="一、准备"></a>一、准备</h1><ul><li>1.官网下载Cloudera Manager和CDH 5.11<br>Cloudera Manager下载地址：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://archive.cloudera.com/cm5/cm/5/</span><br></pre></td></tr></table></figure></li></ul><p>cloudera-manager-el6-cm5.11.0_x86_64.tar.gz</p><p>CDH安装包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://archive.cloudera.com/cdh5/parcels/latest/</span><br></pre></td></tr></table></figure></p><p>CDH-5.11.0-1.cdh5.11.0.p0.34-el6.parcel</p><p>CDH-5.11.0-1.cdh5.11.0.p0.34-el6.parcel.sha1</p><p>manifest.json</p><p>2.JDK 7<br>jdk-7u80-linux-x64.tar.gz</p><p>3.mysql 5.6和最新的mysql JDBC connector<br>mysql-5.6.36-linux-glibc2.5-x86_64.tar.gz</p><p>mysql-connector-java-5.1.44-bin.jar</p><h1 id="二、CentOS6-5安装"><a href="#二、CentOS6-5安装" class="headerlink" title="二、CentOS6.5安装"></a>二、CentOS6.5安装</h1><p>用户/密码</p><p>root/XXXX</p><p>XXX/123</p><p>主机名 IP</p><p>master 192.168.10.111</p><p>slave1 192.168.10.121</p><p>slave2 192.168.10.131</p><p>配置/etc/hostname</p><p>分别是maser和slave1和slave2</p><p>主机名 IP<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">master 192.168.10.11  </span><br><span class="line"></span><br><span class="line">slave1 192.168.10.12</span><br><span class="line"></span><br><span class="line">slave2 192.168.10.13</span><br></pre></td></tr></table></figure></p><p>配置/etc/hostname</p><p>分别是maser和slave1和slave2</p><p>3台都配置/etc/hosts</p><p>加入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">192.168.111 master</span><br><span class="line"></span><br><span class="line">192.168.121 slave1</span><br><span class="line"></span><br><span class="line">192.168.131 slave2</span><br></pre></td></tr></table></figure></p><p>注：安装过程都使用root用户</p><p>CDH 安装在/opt。</p><p>CDH在var目录会放文件，要预留空间</p><p>数据保存在/data</p><h1 id="三、配置SSH无密码登录"><a href="#三、配置SSH无密码登录" class="headerlink" title="三、配置SSH无密码登录"></a>三、配置SSH无密码登录</h1><p>1.查看是否安装openssh和rsync<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep openssh</span><br><span class="line"></span><br><span class="line">rpm -qa | grep rsync</span><br></pre></td></tr></table></figure></p><ol><li>三台都运行<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t dsa -P &apos;&apos; -f ~/.ssh/id_dsa</span><br></pre></td></tr></table></figure></li></ol><p>(-t dsa：表示使用密钥的加密类型，可以为’rsa’和’dsa’)</p><p>3.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><p>这一步，把本机的密钥写入authorized_keys文件</p><p>然后要将其他2台的密钥写入本机的authorized_keys文件</p><p>4.</p><p>master运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp ~/.ssh/id_dsa.pub root@slave1:~/.ssh/ authorized_keys_from_master</span><br><span class="line"></span><br><span class="line">scp ~/.ssh/id_dsa.pub root@slave2:~/.ssh/ authorized_keys_from_master</span><br></pre></td></tr></table></figure></p><p>slave1 运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .ssh/authorized_keys_from_master  &gt;&gt;  ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><p>slave2 运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .ssh/authorized_keys_from_master  &gt;&gt;  ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><p>slave1运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp ~/.ssh/id_dsa.pub root@master:~/.ssh/authorized_keys_from_slave1</span><br><span class="line"></span><br><span class="line">scp ~/.ssh/id_dsa.pub root@slave2:~/.ssh/authorized_keys_from_slave1</span><br></pre></td></tr></table></figure></p><p>master运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .ssh/authorized_keys_from_slave1  &gt;&gt;  ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><p>slave2 运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .ssh/authorized_keys_from_slave1 &gt;&gt;  ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><p>slave2运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp ~/.ssh/id_dsa.pub root@master:~/.ssh/authorized_keys_from_slave2</span><br><span class="line"></span><br><span class="line">scp ~/.ssh/id_dsa.pub root@slave1:~/.ssh/authorized_keys_from_slave2</span><br></pre></td></tr></table></figure></p><p>master运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .ssh/authorized_keys_from_slave2  &gt;&gt;  ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><p>slave2 运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .ssh/authorized_keys_from_slave2 &gt;&gt;  ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><p>最后3台的authorized_keys文件，内容都有3个key</p><p>测试SSH无密码登陆</p><p>在任意一台上，ssh slave1 都可以无密码登陆</p><h1 id="四、同步各时间节点"><a href="#四、同步各时间节点" class="headerlink" title="四、同步各时间节点"></a>四、同步各时间节点</h1><ul><li>1 将3台服务器时间同步，若hbase各节点时间差距过大会报错（默认30秒）</li></ul><p>关闭3台的防火墙<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service iptables stop</span><br><span class="line"></span><br><span class="line">chkconfig iptables off</span><br></pre></td></tr></table></figure></p><p>重启后也生效</p><ul><li>2 配置ntp服务器（master）</li></ul><p>vim /etc/ntp.conf</p><p>然后加入以下配置:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.127.1.0</span><br><span class="line"></span><br><span class="line">fudge 127.127.1.0 stratum 10</span><br></pre></td></tr></table></figure></p><p>注：</p><p>后面那个数字在0-15之间都可以，这样就将这台机器的本地时间作为ntp服务提供给客户端</p><ul><li>3 重启ntpd</li></ul><p>/etc/init.d/ntpd start</p><p>chkconfig  ntpd on下次开机时 自动重启</p><h1 id="五、安装JDK"><a href="#五、安装JDK" class="headerlink" title="五、安装JDK"></a>五、安装JDK</h1><ul><li>1 检查并写在openjdk</li></ul><p>检查命令：java -version 或 rpm -qa | grep java</p><p>卸载命令：rpm –e –nodeps(忽略依赖) 安装包名</p><p>或yum -y remove 安装包名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -e --nodeps java-1.7.0-openjdk-1.7.0.45-2.4.3.3.el6.x86_64</span><br><span class="line"></span><br><span class="line">rpm -e --nodeps java-1.6.0-openjdk-1.6.0.0-1.66.1.13.0.el6.x86_64</span><br></pre></td></tr></table></figure></p><ul><li>2 解压安装</li></ul><p>Jdk版本：jdk-7u80-linux-x64.tar.gz</p><p>解压到/usr/local :</p><p>cd /usr/local;</p><p>tar –zxvf jdk-7u80-linux-x64.tar.gz</p><ul><li>3 配置环境变量</li></ul><p>3台都编辑/etc/profile文件：vim /etc/profile</p><p>加入</p><p>#set java environment<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/jdk1.7.0_80</span><br><span class="line"></span><br><span class="line">export LASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line"></span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure></p><p>使配置生效：source /etc/profile</p><ul><li><p>六、安装mysql<br>mysql安装在slave2 192.168.10.131</p></li><li><p>1 检查是否存在mysql库文件</p></li></ul><p>检查命令：rpm –qa | grep mysql</p><p>若存在则卸载：rpm -e –nodeps mysql-libs-5.1.71-1.el6.x86_64</p><ul><li>2 检查是否存在mysql用户和组</li></ul><p>检查命令：cat /etc/group | grep mysql;</p><p>cat /etc/passwd | grep mysql</p><p>若不存在则创建：groupadd mysql;</p><p>useradd –r –g mysql mysql</p><p>(-r参数表示mysql用户是系统用户，不可用于登录系统)</p><ul><li>3 创建数据、日志存储目录</li></ul><p>命令：mkdir -p /data/mysql/data;  mkdir /var/lib/mysql/log</p><p>更改所属用户：</p><p>chown –R mysql:mysql  /data/mysql</p><p>chown –R mysql:mysql  /usr/local/mysql</p><ul><li>4 解压并初始化</li></ul><p>解压安装包：</p><p>/usr/local目录</p><p>tar –zxvf mysql-5.6.36-linux-glibc2.5-x86_64.tar.gz</p><p>改目录名</p><p>mv mysql-5.6.36-linux-glibc2.5-x86_64 mysql</p><p>初始化参数：</p><p>到mysql目录</p><p>bin/mysqld –initialize –user=mysql –basedir=/usr/local/mysql –datadir=/data/mysql/data</p><p>复制配置文件</p><p>cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql</p><p>cp /usr/local/mysql/support-files/my-default.cnf /etc/my.cnf</p><p>修改</p><p>vi /etc/init.d/mysql</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">basedir=/usr/local/mysql</span><br><span class="line"></span><br><span class="line">datadir=/data/mysql/data</span><br></pre></td></tr></table></figure><p>vi /etc/my.cnf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">basedir =/usr/local/mysql</span><br><span class="line"></span><br><span class="line">datadir =/data/mysql/data</span><br><span class="line"></span><br><span class="line">character_set_server=utf8</span><br></pre></td></tr></table></figure></p><p>在usr/local/mysql/script目录运行</p><p>./mysql_install_db –user=mysql –basedir=/usr/local/mysql –datadir=/data/mysql/data</p><ul><li>5 添加环境变量</li></ul><p>编辑文件：vim /etc/profile<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/usr/local/bin:$PATH</span><br><span class="line">export PATH=/usr/local/mysql/bin:$PATH</span><br></pre></td></tr></table></figure></p><ul><li>6 配置mysql自动启动<br>chmod 755 /etc/init.d/mysql</li></ul><p>chkconfig –add mysql</p><p>设置在运行级别为3和5时mysql自动启动：<br>chkconfig –level 35 mysql on</p><ul><li>7 启动mysql</li></ul><p>命令：bin/mysqld_safe –user=mysql &amp;</p><p>登录mysql  </p><p>bin/mysql –user=root -p</p><p>设置root密码</p><p>set password=password(‘anjian123’);</p><p>()允许root在任何主机登录：<br>grant all privileges on <em>.</em> to ‘root’@’%’ identified by ‘anjian123’  with grant option;</p><p>grant all privileges on <em>.</em> to ‘root’@’master’ identified by ‘anjian123’  with grant option;</p><p>刷新权限表：flush privileges;</p><ul><li>8 创建以下数据库</li></ul><p>create database hive DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</p><p>create database oozie DEFAULT CHARSET utf8 COLLATE utf8_general_ci; </p><p>create database amon DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</p><p>create database hue DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</p><h1 id="七、安装CDH"><a href="#七、安装CDH" class="headerlink" title="七、安装CDH"></a>七、安装CDH</h1><ul><li>1 安装Cloudera Manager Server 和Agent</li></ul><p>主节点解压安装</p><p>cloudera manager的目录默认位置在/opt下，解压：tar xzvf cloudera-manager*.tar.gz将解压后的cm-5.11.0和cloudera目录放到/opt目录下。</p><p>复制mysql-connector-java-5.1.44-bin.jar到目录/usr/share/java和/opt/cm-5.11.0/share/cmf/lib/</p><p>并改名成mysql-connector-java.jar</p><ul><li>2 创建用户cloudera-scm</li></ul><p>在所有节点上执行</p><p>useradd –system –no-create-home –shell=/bin/false –comment “Cloudera SCM User” cloudera-scm</p><ul><li>3 agent配置</li></ul><p>主节点，修改/opt/cm-5.11.0/etc/cloudera-scm-agent/config.ini中的server_host为主节点的主机名。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> # Hostname of the CM server.</span><br><span class="line"></span><br><span class="line">server_host=master</span><br></pre></td></tr></table></figure></p><p>同步Agent到其他所有节点：</p><p>scp -r /opt/cm-5.11.0 root@slave1:/opt/</p><p>scp -r /opt/cm-5.11.0 root@slave2:/opt/</p><ul><li>4 在主节点初始化CM5数据库</li></ul><p>运行</p><p>/opt/cm-5.11.0/share/cmf/schema/scm_prepare_database.sh mysql cm -h slave2 -uroot -panjian123 –scm-host master scm scm scm</p><p>-h后是mysql的主机名</p><p>–scm-host 后是SCM server的主机名（主节点）</p><p>如果有报错，一般是msyql的权限设置没设好，root不能远程登录</p><ul><li>5 准备Parcels，用以安装CDH5</li></ul><p>将CHD5相关的Parcel包放到主节点的/opt/cloudera/parcel-repo/目录中</p><p>相关的文件如下：</p><p>CDH-5.11.0-1.cdh5.11.0.p0.34-el6.parcel</p><p>CDH-5.11.0-1.cdh5.11.0.p0.34-el6.parcel.sha1</p><p>manifest.json</p><p>最后将CDH-5.1.3-1.cdh5.1.3.p0.12-el6.parcel.sha1，重命名为CDH-5.11.0-1.cdh5.11.0.p0.34-el6.parcel.sha</p><ul><li>6 启动脚本</li></ul><p>主节点：通过/opt/cm-5.11.0/etc/init.d/cloudera-scm-server start启动服务端。</p><p>所有节点（包括主节点）：通过/opt/cm-5.11.0/etc/init.d/cloudera-scm-agent start启动Agent服务</p><p>注：</p><p>停止可以用/init.d/cloudera-scm-server stop</p><p>启动成功后，可以用ps –ef|grep cloudera看到这2个进程</p><p>cloudera-scm-agent  的log如果报错:</p><p>[04/Sep/2017 16:29:38 +0000] 2983 MainThread agent        ERROR    Heartbeating to master:7182 failed.</p><p>一般是主节点防火墙没关闭</p><ul><li>7 CDH5的安装配置</li></ul><p><a href="http://192.168.10.111:7180/cmf/login" target="_blank" rel="noopener">http://192.168.10.111:7180/cmf/login</a></p><p>默认的用户名和密码均为admin</p><h1 id="注：CDH安装失败后，重新安装："><a href="#注：CDH安装失败后，重新安装：" class="headerlink" title="注：CDH安装失败后，重新安装："></a>注：CDH安装失败后，重新安装：</h1><p>1) 主节点关闭cloudera-scm-server。所有节点关闭cloudera-scm-agent</p><p>2）删除Agent节点目录</p><p>rm -rf /opt/cm-5.11.0 </p><pre><code>rm -rf /opt/cloudera</code></pre><p>删除主节点目录</p><p>rm -rf /opt/cm-5.11.0</p><p>rm -rf /opt/cloudera</p><p>删除主节点，/var/log/下cloudera相关的目录</p><p>删除主节点，/var/lib/下cloudera相关的目录</p><p>3) 清空CM数据库</p><pre><code>进入Mysql数据库，然后drop database cm;</code></pre><p>4) 删除各节点namenode和datanode节点信息</p><pre><code># rm -rf /opt/dfs/nn/*# rm -rf /opt/dfs/dn/*</code></pre><p>5) 重新安装CDH，主节点解解压：tar xzvf cloudera-manager*.tar.gz将解压后的cm-5.11.0和cloudera目录放到/opt目录下。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;一、准备&quot;&gt;&lt;a href=&quot;#一、准备&quot; class=&quot;headerlink&quot; title=&quot;一、准备&quot;&gt;&lt;/a&gt;一、准备&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;1.官网下载Cloudera Manager和CDH 5.11&lt;br&gt;Cloudera Manager下载地址：
      
    
    </summary>
    
      <category term="搭建" scheme="http://www.wenchong.top/categories/%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="CDH" scheme="http://www.wenchong.top/tags/CDH/"/>
    
  </entry>
  
  <entry>
    <title>zookeeper搭建</title>
    <link href="http://www.wenchong.top/2018/02/15/zookeeper%E5%AE%89%E8%A3%85/"/>
    <id>http://www.wenchong.top/2018/02/15/zookeeper安装/</id>
    <published>2018-02-14T16:00:00.000Z</published>
    <updated>2018-05-18T14:23:32.913Z</updated>
    
    <content type="html"><![CDATA[<ul><li>本文选用：centos6.5、zookeeper-3.4.6<h3 id="集群部署"><a href="#集群部署" class="headerlink" title="集群部署"></a>集群部署</h3>【软件】准备好jdk环境，此次我们的环境是open_jdk1.8.0_101<br>　　　　zookeeper-3.4.6.tar.gz<br>【步骤】</li><li><ol><li>准备条件<br>如果有内部dns或者外网有域名，则直接使用域名<br>如果没有需要修改/etc/hosts文件，或者直接使用IP</li></ol></li></ul><p>集群规划</p><p>主机类型 IP地址  域名<br>zookeeper1 192.168.1.1zookeeper1.chinasoft.com<br>zookeeper2 192.168.1.2zookeeper2.chinasoft.com<br>zookeeper3 192.168.1.3zookeeper3.chinasoft.com</p><p>注意：zookeeper因为有主节点和从节点的关系，所以部署的集群台数最好为奇数个，否则可能出现脑裂导致服务异常</p><ul><li><ol><li>安装<br>下载地址：<a href="http://archive.apache.org/dist/zookeeper/zookeeper-3.4.6/" target="_blank" rel="noopener">http://archive.apache.org/dist/zookeeper/zookeeper-3.4.6/</a><br>解压</li></ol></li></ul><p>tar -zxf zookeeper-3.4.6.tar.gz<br>cd zookeeper-3.4.6</p><p>拷贝配置文件，修改完成后分发给其他节点<br>cd /data/zookeeper-3.4.6/<br>cp zoo_sample.cfg zoo.cfg</p><p>cat zoo.cfg<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/data/zookeeper-3.4.6/data</span><br><span class="line">dataLogDir=/data/zookeeper-3.4.6/logs</span><br><span class="line">clientPort=2181</span><br><span class="line">server.1=u04rtv01.yaya.corp:2888:3888</span><br><span class="line">server.2=u04rtv02.yaya.corp:2888:3888</span><br><span class="line">server.3=u04rtv03.yaya.corp:2888:3888</span><br></pre></td></tr></table></figure></p><ul><li>3.创建data和Log文件夹<br>mkdir /data/zookeeper-3.4.6/data<br>mkdir /data/zookeeper-3.4.6/logs</li></ul><p>　　　　　　　</p><ul><li><p>4、在zoo.cfg中的dataDir指定的目录下，新建myid文件。<br>例如：$ZK_INSTALL/data下，新建myid。在myid文件中输入1。表示为server.1。<br>如果为snapshot/d_2，则myid文件中的内容为 2，依此类推。 </p></li><li><p>启动：在集群中的每台主机上执行如下命令<br>bin/zkServer.sh start </p></li><li><p>查看状态，可以看到其中一台为主节点，其他两台为从节点：<br>bin/zkServer.sh status</p></li><li><p>主节点：<br>./zkServer.sh status</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JMX enabled by default</span><br><span class="line">Using config: /data/yunva/zookeeper-3.4.6/bin/../conf/zoo.cfg</span><br><span class="line">Mode: leader</span><br></pre></td></tr></table></figure></li><li><p>从属节点：<br>./zkServer.sh status</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JMX enabled by default</span><br><span class="line">Using config: /data/yunva/zookeeper-3.4.6/bin/../conf/zoo.cfg</span><br><span class="line">Mode: follower</span><br></pre></td></tr></table></figure></li><li><p>停止：<br>bin/zkServer.sh stop</p></li></ul><p>连接：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bin/zkCli.sh -server zookeeper1:2181 </span><br><span class="line">bin/zkCli.sh -server zookeeper2:2181 </span><br><span class="line">bin/zkCli.sh -server zookeeper3:2181</span><br></pre></td></tr></table></figure></p><ul><li>报错：<br>原因就是没有在dataDir目录下创建myid文件并且赋值(如1、2、3分别代表集群中的server1,server2,server3)</li></ul><p>2016-08-22 17:55:16,145 [myid:] - INFO  [main:QuorumPeerConfig@103] - Reading configuration from: /data/yunva/zookeeper-3.4.6/bin/../conf/zoo.cfg<br>2016-08-22 17:55:16,150 [myid:] - INFO  [main:QuorumPeerConfig@340] - Defaulting to majority quorums<br>2016-08-22 17:55:16,150 [myid:] - ERROR [main:QuorumPeerMain@85] - Invalid config, exiting abnormally<br>org.apache.zookeeper.server.quorum.QuorumPeerConfig$ConfigException: Error processing /data/yunva/zookeeper-3.4.6/bin/../conf/zoo.cfg<br>        at org.apache.zookeeper.server.quorum.QuorumPeerConfig.parse(QuorumPeerConfig.java:123)<br>        at org.apache.zookeeper.server.quorum.QuorumPeerMain.initializeAndRun(QuorumPeerMain.java:101)<br>        at org.apache.zookeeper.server.quorum.QuorumPeerMain.main(QuorumPeerMain.java:78)<br>Caused by: java.lang.IllegalArgumentException: /data/yunva/zookeeper-3.4.6/data/myid file is missing<br>        at org.apache.zookeeper.server.quorum.QuorumPeerConfig.parseProperties(QuorumPeerConfig.java:350)<br>        at org.apache.zookeeper.server.quorum.QuorumPeerConfig.parse(QuorumPeerConfig.java:119)<br>        … 2 more<br>Invalid config, exiting abnormally</p><h3 id="单机部署——适用于开发测试"><a href="#单机部署——适用于开发测试" class="headerlink" title="单机部署——适用于开发测试"></a>单机部署——适用于开发测试</h3><p>tar -zxvf zookeeper-3.4.6.tar.gz<br>cd zookeeper-3.4.6/conf<br>cp zoo_sample.cfg zoo.cfg</p><ul><li><p>创建日志目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /data/yunva/zookeeper-3.4.6/data</span><br><span class="line">mkdir /data/yunva/zookeeper-3.4.6/logs</span><br></pre></td></tr></table></figure></li><li><p>配置：conf/zoo.cfg</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000 </span><br><span class="line">initLimit=10 </span><br><span class="line">syncLimit=5 </span><br><span class="line">dataDir=/data/yunva/zookeeper-3.4.6/logs</span><br><span class="line">dataLogDir=/data/yunva/zookeeper-3.4.6/logs</span><br><span class="line">clientPort=2181</span><br></pre></td></tr></table></figure><p>#自动清除日志文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">autopurge.snapRetainCount=20</span><br><span class="line">autopurge.purgeInterval=48</span><br></pre></td></tr></table></figure></p><ul><li>启动：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh start</span><br></pre></td></tr></table></figure><ul><li><p>连接到Zookeeper：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">bin/zkCli.sh -server 127.0.0.1:2181  适用于Java开发</span><br></pre></td></tr></table></figure></li><li><p>查看状态：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh status</span><br><span class="line">JMX enabled by default</span><br><span class="line">Using config: /data/yunva/zookeeper-3.4.6/bin/../conf/zoo.cfg</span><br><span class="line">Mode: standalone</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;本文选用：centos6.5、zookeeper-3.4.6&lt;h3 id=&quot;集群部署&quot;&gt;&lt;a href=&quot;#集群部署&quot; class=&quot;headerlink&quot; title=&quot;集群部署&quot;&gt;&lt;/a&gt;集群部署&lt;/h3&gt;【软件】准备好jdk环境，此次我们的环境是open_
      
    
    </summary>
    
      <category term="zookeeper" scheme="http://www.wenchong.top/categories/zookeeper/"/>
    
    
      <category term="zookeepere" scheme="http://www.wenchong.top/tags/zookeepere/"/>
    
  </entry>
  
  <entry>
    <title>centos下sqoop环境搭建</title>
    <link href="http://www.wenchong.top/2018/02/15/centos%E4%B8%8Bsqoop%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <id>http://www.wenchong.top/2018/02/15/centos下sqoop环境搭建/</id>
    <published>2018-02-14T16:00:00.000Z</published>
    <updated>2018-05-18T14:19:23.815Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Sqoop是一个用来将Hadoop（Hive、HBase）和关系型数据库中的数据相互转移的工具，可以将一个关系型数据库（例如：MySQL ,Oracle ,Postgres等）中的数据导入到Hadoop的HDFS中，也可以将HDFS的数据导入到关系型数据库中。</li></ul><h3 id="Sqoop安装"><a href="#Sqoop安装" class="headerlink" title="Sqoop安装"></a>Sqoop安装</h3><ul><li>1.下载Sqoop安装包<br>在Sqoop官网下载安装包，本次使用的是sqoop-1.4.6.bin<strong>hadoop-2.0.4-alpha.tar.gz安装在/usr/local目录下，下载地址为<a href="http://apache.fayea.com/sqoop/1.4.6/sqoop-1.4.6.bin" target="_blank" rel="noopener">http://apache.fayea.com/sqoop/1.4.6/sqoop-1.4.6.bin</a></strong>hadoop-2.0.4-alpha.tar.gz</li><li>2.解压Sqoop安装包<br>#进入sqoop安装目录<br>[hadoop@BigData ~]$ cd /usr/local<br>#解压sqoop安装包<br>[hadoop@BigData ~]$ tar -zxvf sqoop-1.4.6.bin<strong>hadoop-2.0.4-alpha.tar.gz<br>#删除sqoop安装包<br>[hadoop@BigData ~]$ rm -rf sqoop-1.4.6.bin</strong>hadoop-2.0.4-alpha.tar.gz<br>#重命名sqoop目录名<br>[hadoop@BigData ~]$ mv sqoop-1.4.6.bin__hadoop-2.0.4-alpha sqoop</li><li>3.配置Sqoop环境变量<br>#配置Sqoop环境变量<br>[root@BigData ~]# vi /etc/profile<br>export SQOOP_HOME=/usr/local/sqoop<br>export PATH=$PATH:$SQOOP_HOME/bin<br>#保存之后记得source，使之前的配置生效<br>source /etc/profile</li><li>4.将关系型数据库驱动包放到sqoop/lib目录下<br>MySql：mysql-connector-java-5.1.30.jar<br>Oracle：ojdbc14.jar</li><li>5.修改Sqoop配置文件<br>[hadoop@BigData ~]$ mv sqoop-env-template.sh sqoop-env.sh<br>[hadoop@BigData ~]$ vi sqoop-env.sh<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#Set path to where bin/hadoop is available</span><br><span class="line">export HADOOP_COMMON_HOME=/usr/local/hadoop</span><br><span class="line">#Set path to where hadoop-*-core.jar is available</span><br><span class="line">export HADOOP_MAPRED_HOME=/usr/local/hadoop</span><br><span class="line">#set the path to where bin/hbase is available</span><br><span class="line">export HBASE_HOME=/usr/local/hbase</span><br><span class="line">#Set the path to where bin/hive is available</span><br><span class="line">export HIVE_HOME=/usr/local/hive</span><br><span class="line">#Set the path for where zookeper config dir is</span><br><span class="line">export ZOOCFGDIR=/usr/local/zookeeper</span><br></pre></td></tr></table></figure></li></ul><p>到此，sqoop环境就已搭建成功！</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;Sqoop是一个用来将Hadoop（Hive、HBase）和关系型数据库中的数据相互转移的工具，可以将一个关系型数据库（例如：MySQL ,Oracle ,Postgres等）中的数据导入到Hadoop的HDFS中，也可以将HDFS的数据导入到关系型数据库中。&lt;
      
    
    </summary>
    
      <category term="Sqoop" scheme="http://www.wenchong.top/categories/Sqoop/"/>
    
    
      <category term="sqoop" scheme="http://www.wenchong.top/tags/sqoop/"/>
    
  </entry>
  
  <entry>
    <title>docker安装</title>
    <link href="http://www.wenchong.top/2018/02/05/docker%E5%AE%89%E8%A3%85/"/>
    <id>http://www.wenchong.top/2018/02/05/docker安装/</id>
    <published>2018-02-05T13:09:56.999Z</published>
    <updated>2018-05-18T14:20:59.192Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1：关闭selinux"><a href="#1：关闭selinux" class="headerlink" title="1：关闭selinux"></a>1：关闭selinux</h2><p>临时关闭：setenforce 0<br>永久关闭：</p><h2 id="1-vi-etc-sysconfig-selinux"><a href="#1-vi-etc-sysconfig-selinux" class="headerlink" title="1. vi /etc/sysconfig/selinux"></a>1. vi /etc/sysconfig/selinux</h2><p>插入/编辑以下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELINUX=disabled</span><br></pre></td></tr></table></figure></p><p>#重启生效</p><h2 id="2：在Fedora-EPEL源中已经提供了docker-io包，下载安装epel："><a href="#2：在Fedora-EPEL源中已经提供了docker-io包，下载安装epel：" class="headerlink" title="2：在Fedora EPEL源中已经提供了docker-io包，下载安装epel："></a>2：在Fedora EPEL源中已经提供了docker-io包，下载安装epel：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh http://mirrors.sohu.com/fedora-epel/6/x86_64/epel-release-6-8.noarch.rpm</span><br><span class="line">sed -i &apos;s/^mirrorlist=https/mirrorlist=http/&apos; /etc/yum.repos.d/epel.repo</span><br><span class="line">（elpe.repo）</span><br><span class="line">[epel]</span><br><span class="line">name=epel</span><br><span class="line">mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=epel-$releasever&amp;arch=$basearch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><h2 id="3：安装docker"><a href="#3：安装docker" class="headerlink" title="3：安装docker"></a>3：安装docker</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker-io</span><br></pre></td></tr></table></figure><p>安装完成后</p><h2 id="4：启动docker"><a href="#4：启动docker" class="headerlink" title="4：启动docker"></a>4：启动docker</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service  docker  start</span><br></pre></td></tr></table></figure><h2 id="5：查看docker版本"><a href="#5：查看docker版本" class="headerlink" title="5：查看docker版本"></a>5：查看docker版本</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker vesion</span><br></pre></td></tr></table></figure><h2 id="6：查看docker日志"><a href="#6：查看docker日志" class="headerlink" title="6：查看docker日志"></a>6：查看docker日志</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/docker</span><br></pre></td></tr></table></figure><p>docker安装完成</p><h1 id="一：卸载docker"><a href="#一：卸载docker" class="headerlink" title="一：卸载docker"></a>一：卸载docker</h1><p>列出你安装过的包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# yum list installed | grep docker</span><br><span class="line">docker-io.x86_64   1.7.1-2.el6                        @epel</span><br></pre></td></tr></table></figure></p><p>删除软件包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y remove docker-io.x86_64</span><br></pre></td></tr></table></figure></p><p>删除镜像/容器等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /var/lib/docker</span><br></pre></td></tr></table></figure></p><h1 id="二：升级docker版本为1-10-3"><a href="#二：升级docker版本为1-10-3" class="headerlink" title="二：升级docker版本为1.10.3"></a>二：升级docker版本为1.10.3</h1><p>升级之前停止docker服务,并将原有的docker服务进行备份.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv /usr/bin/docker /usr/bin/docker.bak</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup wget -c https://get.docker.com/builds/Linux/x86_64/docker-1.10.3 -O /usr/bin/docker</span><br></pre></td></tr></table></figure><p>给执行权限：chmod 755 /usr/bin/docker 然后重启服务，并查看版本.</p><h2 id="报错："><a href="#报错：" class="headerlink" title="报错："></a>报错：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Starting cgconfig service: Error: cannot mount memory to /cgroup/memory: No such file or directory</span><br><span class="line">/sbin/cgconfigparser; error loading /etc/cgconfig.conf: Cgroup mounting failed</span><br><span class="line">Failed to parse /etc/cgconfig.conf                         [FAILED]</span><br><span class="line">Starting docker:                                       [  OK  ]</span><br></pre></td></tr></table></figure><h2 id="修改：-etc-cgconfig-conf文件"><a href="#修改：-etc-cgconfig-conf文件" class="headerlink" title="修改：/etc/cgconfig.conf文件"></a>修改：/etc/cgconfig.conf文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mount &#123;</span><br><span class="line">    cpuset  = /cgroup/cpuset;</span><br><span class="line">    cpu = /cgroup/cpu;</span><br><span class="line">    cpuacct = /cgroup/cpuacct;</span><br><span class="line">#   memory  = /cgroup/memory;</span><br><span class="line">    devices = /cgroup/devices;</span><br><span class="line">    freezer = /cgroup/freezer;</span><br><span class="line">    net_cls = /cgroup/net_cls;</span><br><span class="line">    blkio   = /cgroup/blkio;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重新启动docker 正常</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1：关闭selinux&quot;&gt;&lt;a href=&quot;#1：关闭selinux&quot; class=&quot;headerlink&quot; title=&quot;1：关闭selinux&quot;&gt;&lt;/a&gt;1：关闭selinux&lt;/h2&gt;&lt;p&gt;临时关闭：setenforce 0&lt;br&gt;永久关闭：&lt;/p&gt;
&lt;h2
      
    
    </summary>
    
      <category term="docker" scheme="http://www.wenchong.top/categories/docker/"/>
    
    
      <category term="docker" scheme="http://www.wenchong.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>致橡树</title>
    <link href="http://www.wenchong.top/2018/01/13/%E8%87%B4%E6%A9%A1%E6%A0%91/"/>
    <id>http://www.wenchong.top/2018/01/13/致橡树/</id>
    <published>2018-01-12T16:00:00.000Z</published>
    <updated>2018-05-25T09:25:35.759Z</updated>
    
    <content type="html"><![CDATA[<ul><li>文学的力量往往是在于对人信仰的改变</li></ul><p>我如果爱你——<br>绝不像攀援的凌霄花，<br>借你的高枝炫耀自己；<br>我如果爱你——<br>绝不学痴情的鸟儿，<br>为绿荫重复单调的歌曲；<br>也不止像泉源，<br>常年送来清凉的慰藉；<br>也不止像险峰，<br>增加你的高度，衬托你的威仪。<br>甚至日光，<br>甚至春雨。</p><p>不，这些都还不够！<br>我必须是你近旁的一株木棉，<br>作为树的形象和你站在一起。<br>根，紧握在地下；<br>叶，相触在云里。<br>每一阵风过，<br>我们都互相致意，<br>但没有人，<br>听懂我们的言语。<br>你有你的铜枝铁干，<br>像刀，像剑，也像戟；<br>我有我红硕的花朵，<br>像沉重的叹息，<br>又像英勇的火炬。</p><p>我们分担寒潮、风雷、霹雳；<br>我们共享雾霭、流岚、虹霓。<br>仿佛永远分离，<br>却又终身相依。<br>这才是伟大的爱情，<br>坚贞就在这里：<br>爱——<br>不仅爱你伟岸的身躯，<br>也爱你坚持的位置，<br>足下的土地。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;文学的力量往往是在于对人信仰的改变&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我如果爱你——&lt;br&gt;绝不像攀援的凌霄花，&lt;br&gt;借你的高枝炫耀自己；&lt;br&gt;我如果爱你——&lt;br&gt;绝不学痴情的鸟儿，&lt;br&gt;为绿荫重复单调的歌曲；&lt;br&gt;也不止像泉源，&lt;br&gt;常年送来清凉的慰藉；
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Centos7伪分布式安装Hadoop2.6和Hbase0.94</title>
    <link href="http://www.wenchong.top/2017/12/01/centos7+hadoop2.6+hbase1.0.x/"/>
    <id>http://www.wenchong.top/2017/12/01/centos7+hadoop2.6+hbase1.0.x/</id>
    <published>2017-11-30T16:00:00.000Z</published>
    <updated>2018-05-18T14:17:28.053Z</updated>
    
    <content type="html"><![CDATA[<h1 id="只记录那二年踏过的坑"><a href="#只记录那二年踏过的坑" class="headerlink" title="只记录那二年踏过的坑"></a>只记录那二年踏过的坑</h1><h2 id="一、安装Jdk：首先需要卸载系统自带的openjava，查看系统的Java：-rpm-qa-grep-java。"><a href="#一、安装Jdk：首先需要卸载系统自带的openjava，查看系统的Java：-rpm-qa-grep-java。" class="headerlink" title="一、安装Jdk：首先需要卸载系统自带的openjava，查看系统的Java： rpm -qa|grep java。"></a>一、安装Jdk：首先需要卸载系统自带的openjava，查看系统的Java： rpm -qa|grep java。</h2><ul><li>卸载： yum -y remove java javaxxxxx(系统自带的Java版本)</li></ul><p>安装jdk，将jdk.tar.gz文件复制到/usr/java中,终端进入/mnt/share ,cp jdk.tar.gz /usr/ava，进入/usr/java解压：tar xzvf jdk.targz</p><p>配置环境变量：vi /etc/profile 输入i编辑<br>在尾部添加：export JAVA_HOME=/usr/java/jdkxxxx<br>export PATH=$JAVA_HOME/bin:$PATH<br>export CLASSPATH=.:JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</p><p>保存并退出： wq<br>使修改生效： source /etc/profile<br>查看Java版本：java -version</p><h2 id="二、Hadoop伪分布式安装"><a href="#二、Hadoop伪分布式安装" class="headerlink" title="二、Hadoop伪分布式安装"></a>二、Hadoop伪分布式安装</h2><ul><li>1、ssh无密码登陆</li></ul><p>终端：ssh-keygen -t rsa (获得rsa公钥私钥,id_rsa和id_rsa.pub)<br>cd .ssh<br>cp id_rsa.pub authorized_keys (将公钥复制给authorized_keys) &lt;分布式则要将所有节点id_rsa.pub相互复制&gt;</p><ul><li>2、 /mnt/share cp hadoop2.x /usr.hadoop</li></ul><p>解压tar xzvf hadoop 2.x</p><ul><li>3、修改core-site.xml、hadoop-env.sh、hdfs-site.xml、mapred-site.xml 、yarn-site.xml(hadoop2.x版本的配置文件在/hadoop2.x/etc/hadoop下)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">①core-site.xml：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fs.default.name</span><br><span class="line">hdfs://localhost:9000</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">② hadoop-env.sh：</span><br><span class="line">export JAVA_HOME=/usr/java/jdkxxx (jdk路径)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">③ hdfs-site.xml： 先创建好数据节点和名称节点的存放路径</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dfs.datanode.data.dir</span><br><span class="line">/user/hadoop/hadoop-2.5.1/data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dfs.namenode.name.dir</span><br><span class="line">/user/hadoop/hadoop-2.5.1/name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dfs.replication</span><br><span class="line">1</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">④mapred-site.xml: (注意：这个文件是将/hadoop2.x/etc/hadoop下的mapred-site.xml.template复制并重命名 )</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mapreduce.framework.name</span><br><span class="line">yarn</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">⑤yarn-site.xml：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yarn.nodemanager.aux-services</span><br><span class="line">mapreduce_shuffle</span><br></pre></td></tr></table></figure><ul><li>4、namenode格式化（一定要完成）</li></ul><p>终端：cd /usr/hadoop/hadoop-2.5.1/bin</p><p>./hdfs namenode -format (输入./hadoop namenode -format也行)</p><ul><li>5、运行hadoop</li></ul><p>终端： cd /usr/hadoop/hadoop-2.5.1/sbin (2.x版本后启动/停止在sbin目录下)<br>./start-hdfs.sh<br>./start-yarn.sh<br>(也可以只输入./start-all.sh)</p><p>输入jps查看启动项，当启动了NameNode、DataNode、SecondaryNameNode、ResourceManager、NodeManager即ok。</p><p>可进入Firefox中，输入端口号： localhost:50070 进入hadoop可视化页面。</p><h2 id="三、Hbase0-94安装"><a href="#三、Hbase0-94安装" class="headerlink" title="三、Hbase0.94安装"></a>三、Hbase0.94安装</h2><ul><li>1、/mnt/share cp hbase1.0.1 /usr.hbase</li></ul><p>解压tar xzvf hbase1.0.1</p><ul><li>2、修改hbase配置文件hbase-env.sh、hbase-site.xml<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hbase-env.sh:</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/usr/java/jdkxxxx (java路径)</span><br><span class="line">export HBASE_MANAGES_ZK=true (都得去掉前面#)</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">hbase-site.xml：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hbase.rootdir</span><br><span class="line">hdfs://localhost:9000/hbase</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hbase.cluster.distributed</span><br><span class="line">true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hbase.zookeeper.quorum</span><br><span class="line">localhost</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hbase.tmp.dir</span><br><span class="line">file:/usr/hbase/tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hbase.zookeeper.property.dataDir</span><br><span class="line">file:/usr/hbase/zookeeperdata</span><br></pre></td></tr></table></figure><ul><li>3、运行hbase</li></ul><p>运行前需先启动hadoop，再进入hbase的bin目录下输入指令 ./start-hbase.sh<br>输入jps查看启动项，如有HMaster、HRegionServer、HQuormPeer,则说明hbase启动成功。<br>输入./hbase Shell (进入shell指令，可通过shell指令建表)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;只记录那二年踏过的坑&quot;&gt;&lt;a href=&quot;#只记录那二年踏过的坑&quot; class=&quot;headerlink&quot; title=&quot;只记录那二年踏过的坑&quot;&gt;&lt;/a&gt;只记录那二年踏过的坑&lt;/h1&gt;&lt;h2 id=&quot;一、安装Jdk：首先需要卸载系统自带的openjava，查看系统的
      
    
    </summary>
    
      <category term="搭建" scheme="http://www.wenchong.top/categories/%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="ambari" scheme="http://www.wenchong.top/tags/ambari/"/>
    
  </entry>
  
  <entry>
    <title>centos 6.5 内核升级</title>
    <link href="http://www.wenchong.top/2017/11/15/centos6.5%E5%86%85%E6%A0%B8%E5%8D%87%E7%BA%A7/"/>
    <id>http://www.wenchong.top/2017/11/15/centos6.5内核升级/</id>
    <published>2017-11-14T16:00:00.000Z</published>
    <updated>2018-05-18T14:16:20.683Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-查看centos的内核版本"><a href="#1-查看centos的内核版本" class="headerlink" title="1.查看centos的内核版本"></a>1.查看centos的内核版本</h2><p>rname -r</p><h2 id="2-查看系统版本"><a href="#2-查看系统版本" class="headerlink" title="2.查看系统版本"></a>2.查看系统版本</h2><p>cat /etc/centos-release</p><h2 id="3-安装软件"><a href="#3-安装软件" class="headerlink" title="3.安装软件"></a>3.安装软件</h2><p>编译安装新内核，依赖于开发环境和开发库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum grouplist  //查看已经安装的和未安装的软件包组，来判断我们是否安装了相应的开发环境和开发库；</span><br><span class="line"></span><br><span class="line">yum groupinstall &quot;Development Tools&quot;  //一般是安装这两个软件包组，这样做会确定你拥有编译时所需的一切工具</span><br><span class="line"></span><br><span class="line">yum install ncurses-devel //你必须这样才能让 make *config 这个指令正确地执行</span><br><span class="line"></span><br><span class="line">yum install qt-devel //如果你没有 X 环境，这一条可以不用</span><br><span class="line"></span><br><span class="line">yum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel //创建 CentOS-6 内核时需要它们</span><br></pre></td></tr></table></figure></p><h2 id="4-编译内核"><a href="#4-编译内核" class="headerlink" title="4.编译内核"></a>4.编译内核</h2><p>Linux内核版本有两种：稳定版和开发版 ，Linux内核版本号由3个数字组成： r.x.y</p><ul><li>r: 主版本号</li><li>x: 次版本号，偶数表示稳定版本；奇数表示开发中版本。</li><li>y: 修订版本号 ， 表示修改的次数<br>官网上有stable, longterm等版本，longterm是比stable更稳定的版本。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">`[root@sean ~]#curl -O -L  https://www.kernel.org/pub/linux/kernel/v3.x/linux-3.10.28.tar.xz</span><br><span class="line">[root@sean ~]# tar -xf linux-3.10.58.tar.xz -C /usr/src/</span><br><span class="line">[root@sean ~]# cd /usr/src/linux-3.10.58/</span><br><span class="line">[root@sean linux-3.10.58]# cp /boot/config-2.6.32-220.el6.x86_64 .config`</span><br></pre></td></tr></table></figure></li></ul><p>我们在系统原有的内核配置文件的基础上建立新的编译选项，所以复制一份到当前目录下，命名为.config。接下来继续配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[root@sean linux-3.10.58]# sh -c &apos;yes &quot;&quot; | make oldconfig&apos;</span><br><span class="line">  </span><br><span class="line">HOSTCC  scripts/basic/fixdep</span><br><span class="line">  </span><br><span class="line">HOSTCC  scripts/kconfig/conf.o</span><br><span class="line">  </span><br><span class="line">SHIPPED scripts/kconfig/zconf.tab.c</span><br><span class="line">  </span><br><span class="line">SHIPPED scripts/kconfig/zconf.lex.c</span><br><span class="line">  </span><br><span class="line">SHIPPED scripts/kconfig/zconf.hash.c</span><br><span class="line">  </span><br><span class="line">HOSTCC  scripts/kconfig/zconf.tab.o</span><br><span class="line">  </span><br><span class="line">HOSTLD  scripts/kconfig/conf</span><br><span class="line"></span><br><span class="line">scripts/kconfig/conf --oldconfig Kconfig</span><br><span class="line"></span><br><span class="line">.config:555:warning: symbol value &apos;m&apos; invalid for PCCARD_NONSTATIC</span><br><span class="line">.config:2567:warning: symbol value &apos;m&apos; invalid for MFD_WM8400</span><br><span class="line">.config:2568:warning: symbol value &apos;m&apos; invalid for MFD_WM831X</span><br><span class="line">.config:2569:warning: symbol value &apos;m&apos; invalid for MFD_WM8350</span><br><span class="line">.config:2582:warning: symbol value &apos;m&apos; invalid for MFD_WM8350_I2C</span><br><span class="line">.config:2584:warning: symbol value &apos;m&apos; invalid for AB3100_CORE</span><br><span class="line">.config:3502:warning: symbol value &apos;m&apos; invalid for MMC_RICOH_MMC</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* Restart config...</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* General setup</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">XZ decompressor tester (XZ_DEC_TEST) [N/m/y/?] (NEW)</span><br><span class="line"></span><br><span class="line">Averaging functions (AVERAGE) [Y/?] (NEW) </span><br><span class="line">y</span><br><span class="line">CORDIC algorithm (CORDIC) [N/m/y/?] (NEW) </span><br><span class="line"></span><br><span class="line">JEDEC DDR data (DDR) [N/y/?] (NEW) </span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">configuration written to .config</span><br></pre></td></tr></table></figure></p><p>make oldconfig会读取当前目录下的.config文件，在.config文件里没有找到的选项则提示用户填写，然后备份.config文件为.config.old，并生成新的.config文件</p><h2 id="5-开始编译"><a href="#5-开始编译" class="headerlink" title="5.开始编译"></a>5.开始编译</h2><p>[root@sean linux-3.10.58]# make -j4 bzImage  //生成内核文件<br>[root@sean linux-3.10.58]# make -j4 modules  //编译模块<br>[root@sean linux-3.10.58]# make -j4 modules_install  //编译安装模块</p><p>-j后面的数字是线程数，用于加快编译速度，一般的经验是，逻辑CPU，就填写那个数字，例如有8核，则为-j8。（modules部分耗时30多分钟）</p><h2 id="6-安装"><a href="#6-安装" class="headerlink" title="6.安装"></a>6.安装</h2><p>[root@sean linux-3.10.58]# make install<br>实际运行到这一步时，出现ERROR: modinfo: could not find module vmware_balloon，但是不影响内核安装，是由于vsphere需要的模块没有编译，要避免这个问题，需要在make之前时修改.config文件，加入<br>HYPERVISOR_GUEST=yCONFIG_VMWARE_BALLOON=m<br>（这一部分比较容易出问题，参考下文异常部分）</p><h2 id="7-修改grub引导，重启"><a href="#7-修改grub引导，重启" class="headerlink" title="7.修改grub引导，重启"></a>7.修改grub引导，重启</h2><p>安装完成后，需要修改Grub引导顺序，让新安装的内核作为默认内核。<br>编辑 grub.conf文件，<br>vi /etc/grub.conf</p><p>#boot=/dev/sda<br>default=0<br>timeout=5<br>splashimage=(hd0,0)/grub/splash.xpm.gz<br>hiddenmenu<br>title CentOS (3.10.58)<br>    root (hd0,0)<br>…</p><p>数一下刚刚新安装的内核在哪个位置，从0开始，然后设置default为那个数字，一般新安装的内核在第一个位置，所以设置default=0。<br>重启reboot now</p><h2 id="8-确认当内核版本"><a href="#8-确认当内核版本" class="headerlink" title="8.确认当内核版本"></a>8.确认当内核版本</h2><p>[root@sean ~]# uname -r<br>3.10.58</p><p>升级内核成功!</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-查看centos的内核版本&quot;&gt;&lt;a href=&quot;#1-查看centos的内核版本&quot; class=&quot;headerlink&quot; title=&quot;1.查看centos的内核版本&quot;&gt;&lt;/a&gt;1.查看centos的内核版本&lt;/h2&gt;&lt;p&gt;rname -r&lt;/p&gt;
&lt;h2 i
      
    
    </summary>
    
      <category term="运维" scheme="http://www.wenchong.top/categories/operation/"/>
    
    
      <category term="operation" scheme="http://www.wenchong.top/tags/operation/"/>
    
  </entry>
  
  <entry>
    <title>centos6.5下搭建hadoop2.7单机伪分布环境</title>
    <link href="http://www.wenchong.top/2017/10/01/centos6.5+hadoop2.7/"/>
    <id>http://www.wenchong.top/2017/10/01/centos6.5+hadoop2.7/</id>
    <published>2017-09-30T16:00:00.000Z</published>
    <updated>2018-05-18T14:15:22.366Z</updated>
    
    <content type="html"><![CDATA[<h3 id="设置固定IP地址及网关"><a href="#设置固定IP地址及网关" class="headerlink" title="设置固定IP地址及网关"></a>设置固定IP地址及网关</h3><ul><li><p>设置IP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-eth0</span><br></pre></td></tr></table></figure></li><li><p>修改内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eth0</span><br><span class="line">HWADDR=08:00:27:BD:9D:B5  #不用改</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">UUID=53e4e4b6-9724-43ab-9da7-68792e611031 #不用改</span><br><span class="line">ONBOOT=yes  #开机启动</span><br><span class="line">NM_CONTROLLED=yes</span><br><span class="line">BOOTPROTO=static  #静态IP</span><br><span class="line">IPADDR=192.168.30.50  #IP地址</span><br><span class="line">NETMASK=255.255.255.0 #子网掩码</span><br></pre></td></tr></table></figure></li><li><p>设置网关</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/network</span><br></pre></td></tr></table></figure></li><li><p>添加内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HOSTNAME=Hadoop.Master</span><br><span class="line">GATEWAY=192.168.30.1 #网关</span><br></pre></td></tr></table></figure></li><li><p>设置DNS<br>vi /etc/resolv.conf</p></li><li>添加内容<br>nameserver xxx.xxx.xxx.xxx #根据实际情况设置<br>nameserver 114.114.114.114 #可以设置多个</li><li><p>重启网卡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network restart</span><br></pre></td></tr></table></figure></li><li><p>设置主机名对应IP地址</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure></li></ul><p>#添加如下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.30.50 Hadoop.Master</span><br></pre></td></tr></table></figure></p><h3 id="添加Hadoop用户"><a href="#添加Hadoop用户" class="headerlink" title="添加Hadoop用户"></a>添加Hadoop用户</h3><ul><li><p>添加用户组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd hadoop</span><br></pre></td></tr></table></figure></li><li><p>添加用户并分配用户组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -g hadoop hadoop</span><br></pre></td></tr></table></figure></li><li><p>修改用户密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd hadoop</span><br></pre></td></tr></table></figure></li></ul><h3 id="关闭服务"><a href="#关闭服务" class="headerlink" title="关闭服务"></a>关闭服务</h3><ul><li><p>关闭防火墙</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">service iptables stop #关闭防火墙服务</span><br><span class="line">chkconfig iptables off #关闭防火墙开机启动</span><br><span class="line">service ip6tables stop</span><br><span class="line">chkconfig ip6tables off</span><br></pre></td></tr></table></figure></li><li><p>关闭SELinux</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/selinux</span><br></pre></td></tr></table></figure></li></ul><p>#修改如下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELINUX=enforcing -&gt; SELINUX=disabled</span><br></pre></td></tr></table></figure></p><p>#再执行如下命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0</span><br><span class="line">getenforce</span><br></pre></td></tr></table></figure></p><ul><li>关闭其他服务<h3 id="VSFTP安装与配置"><a href="#VSFTP安装与配置" class="headerlink" title="VSFTP安装与配置"></a>VSFTP安装与配置</h3></li><li><p>检查是否安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list|grep vsftpd</span><br></pre></td></tr></table></figure></li><li><p>安装vsftp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install vsftpd</span><br></pre></td></tr></table></figure></li><li><p>创建日志文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch /var/log/vdftpd.log</span><br></pre></td></tr></table></figure></li><li><p>配置vsftpd服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure></li></ul><p>#修改如下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">anonymous_enable=NO #关闭匿名访问</span><br><span class="line">xferlog_file=/var/log/vsftpd.log #设置日志文件 -- 我们上一步所创建的文件</span><br><span class="line">idle_session_timeout=600 #会话超时时间</span><br><span class="line">async_abor_enable=YES  #开启异步传输</span><br><span class="line">ascii_upload_enable=YES #开启ASCII上传</span><br><span class="line">ascii_download_enable=YES #开启ASCII下载</span><br></pre></td></tr></table></figure></p><ul><li>查看vsftp运行状态<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service vsftpd status</span><br></pre></td></tr></table></figure></li></ul><h3 id="启动vsftp"><a href="#启动vsftp" class="headerlink" title="启动vsftp"></a>启动vsftp</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service vsftpd start</span><br><span class="line">#重启 service vsftpd restart</span><br><span class="line">#关闭 service vsftpd stop</span><br></pre></td></tr></table></figure><ul><li><p>查看vsftpd服务启动项</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --list|grep vsftpd</span><br></pre></td></tr></table></figure></li><li><p>设置vsftp开机启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig vsftpd on</span><br></pre></td></tr></table></figure></li></ul><h3 id="SSH无密码配置"><a href="#SSH无密码配置" class="headerlink" title="SSH无密码配置"></a>SSH无密码配置</h3><ul><li><p>查看ssh与rsync安装状态</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa|grep openssh</span><br><span class="line">rpm -qa|grep rsync</span><br></pre></td></tr></table></figure></li><li><p>安装ssh与rsync</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install ssh</span><br><span class="line">yum -y install rsync</span><br></pre></td></tr></table></figure></li><li><p>切换hadoop用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su - hadoop</span><br></pre></td></tr></table></figure></li><li><p>生成ssh密码对</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -P &apos;&apos; -f ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure></li><li><p>将id_dsa.pub追加到授权的key中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></li></ul><h3 id="设置授权key权限"><a href="#设置授权key权限" class="headerlink" title="设置授权key权限"></a>设置授权key权限</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>#权限的设置非常重要，因为不安全的设置安全设置，会让你不能使用RSA功能</p><h3 id="测试ssh连接"><a href="#测试ssh连接" class="headerlink" title="测试ssh连接"></a>测试ssh连接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh localhost</span><br></pre></td></tr></table></figure><p>#如果不需要输入密码，则是成功</p><h2 id="安装Java"><a href="#安装Java" class="headerlink" title="安装Java"></a>安装Java</h2><ul><li>下载地址<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html</span><br></pre></td></tr></table></figure></li></ul><p>注：我这里使用的是：jdk-7u80-linux-i586.tar.gz</p><ul><li><p>安装Java<br>切换至root用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br></pre></td></tr></table></figure></li><li><p>创建/usr/java文件夹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/java</span><br></pre></td></tr></table></figure></li><li><p>使用winscp工具上传至服务器</p></li><li><p>将压缩包上传至/home/hadoop目录</p></li></ul><p>注：我这里使用的是winscp，使用hadoop用户连接</p><ul><li><p>将压缩包解压至/usr/java 目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf /home/hadoop/jdk-7u80-linux-i586.tar.gz -C /usr/java/</span><br></pre></td></tr></table></figure></li><li><p>设置环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure></li></ul><p>#追加如下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.7.0_80</span><br><span class="line">export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure></p><ul><li><p>使环境变量生效</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>测试环境变量设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></li></ul><h2 id="Hadoop安装与配置"><a href="#Hadoop安装与配置" class="headerlink" title="Hadoop安装与配置"></a>Hadoop安装与配置</h2><p>下载地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://hadoop.apache.org/releases.html</span><br></pre></td></tr></table></figure></p><p>注:我下载的是hadoop-2.7.1.tar.gz</p><h3 id="安装Hadoop"><a href="#安装Hadoop" class="headerlink" title="安装Hadoop"></a>安装Hadoop</h3><p>使用winscp工具上传至服务器<br>将压缩包上传至/home/hadoop目录<br>*将压缩包解压至/usr目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf /home/hadoop/hadoop-2.7.1.tar.gz -C /usr/</span><br></pre></td></tr></table></figure></p><ul><li><p>修改文件夹名称</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv /usr/hadoop-2.7.1/ /usr/hadoop</span><br></pre></td></tr></table></figure></li><li><p>创建hadoop数据目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/hadoop/tmp</span><br></pre></td></tr></table></figure></li><li><p>将hadoop文件夹授权给hadoop用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R hadoop:hadoop /usr/hadoop/</span><br></pre></td></tr></table></figure></li><li><p>设置环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure></li></ul><p>#追加如下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_HOME=/usr/hadoop</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</span><br><span class="line">export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native</span><br><span class="line">export HADOOP_OPTS=&quot;-Djava.library.path=$HADOOP_HOME/lib</span><br></pre></td></tr></table></figure></p><ul><li><p>使环境变量生效</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>测试环境变量设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop version</span><br></pre></td></tr></table></figure></li></ul><h3 id="配置HDFS"><a href="#配置HDFS" class="headerlink" title="配置HDFS"></a>配置HDFS</h3><ul><li><p>切换至Hadoop用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su - hadoop</span><br></pre></td></tr></table></figure></li><li><p>修改hadoop-env.sh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/hadoop/etc/hadoop/</span><br></pre></td></tr></table></figure></li></ul><p>vi hadoop-env.sh </p><p>#追加如下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.7.0_80</span><br></pre></td></tr></table></figure></p><ul><li><p>修改core-site.xml<br>vi core-site.xml<br>#添加如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;hdfs://Hadoop.Master:9000&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;/usr/hadoop/tmp/&lt;/value&gt;</span><br><span class="line">        &lt;description&gt;A base for other temporary directories.&lt;/description&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>修改hdfs-site.xml<br>vi hdfs-site.xml<br>#添加如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;1&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>格式化hdfs<br>hdfs namenode -format<br>注：出现Exiting with status 0即为成功</p></li><li><p>启动hdfs<br>start-dfs.sh<br>#停止命令 stop-dfs.sh<br>注：输出如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">15/09/21 18:09:13 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</span><br><span class="line">Starting namenodes on [Hadoop.Master]</span><br><span class="line">Hadoop.Master: starting namenode, logging to /usr/hadoop/logs/hadoop-hadoop-namenode-Hadoop.Master.out</span><br><span class="line">Hadoop.Master: starting datanode, logging to /usr/hadoop/logs/hadoop-hadoop-datanode-Hadoop.Master.out</span><br><span class="line">Starting secondary namenodes [0.0.0.0]</span><br><span class="line">The authenticity of host &apos;0.0.0.0 (0.0.0.0)&apos; can&apos;t be established.</span><br><span class="line">RSA key fingerprint is b5:96:b2:68:e6:63:1a:3c:7d:08:67:4b:ae:80:e2:e3.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">0.0.0.0: Warning: Permanently added &apos;0.0.0.0&apos; (RSA) to the list of known hosts.</span><br><span class="line">0.0.0.0: starting secondarynamenode, logging to /usr/hadoop/logs/hadoop-hadoop-secondarynamenode-Hadoop.Master.out</span><br><span class="line">15/09/21 18:09:45 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicab</span><br></pre></td></tr></table></figure></li><li><p>查看进程<br>jps<br>注：输出类似如下内容<br>1763 NameNode<br>1881 DataNode<br>2146 Jps<br>2040 SecondaryNameNode</p></li><li>使用web查看Hadoop运行状态<br><a href="http://你的服务器ip地址:50070/" target="_blank" rel="noopener">http://你的服务器ip地址:50070/</a><h3 id="在HDFS上运行WordCount"><a href="#在HDFS上运行WordCount" class="headerlink" title="在HDFS上运行WordCount"></a>在HDFS上运行WordCount</h3></li><li>创建HDFS用户目录<br>hdfs dfs -mkdir /user<br>hdfs dfs -mkdir /user/hadoop #根据自己的情况调整/user/<username></username></li><li>复制输入文件（要处理的文件）到HDFS上<br>hdfs dfs -put /usr/hadoop/etc/hadoop input</li><li>查看我们复制到HDFS上的文件<br>hdfs dfs -ls input</li><li>运行单词检索（grep）程序<br>hadoop jar /usr/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar grep input output ‘dfs[a-z.]+’<br>#WordCount<br>#hadoop jar /usr/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar wordcount input output<br>#说明：output文件夹如已经存在则需要删除或指定其他文件夹。</li><li>查看运行结果<br>hdfs dfs -cat output/*<h3 id="配置YARN"><a href="#配置YARN" class="headerlink" title="配置YARN"></a>配置YARN</h3></li><li><p>修改mapred-site.xml<br>cd /usr/hadoop/etc/hadoop/<br>cp mapred-site.xml.template mapred-site.xml<br>vi mapred-site.xml<br>#添加如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>修改yarn-site.xml<br>vi yarn-site.xml<br>#添加如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li><li><p>启动YARN<br>start-yarn.sh<br>#停止yarn stop-yarn.sh</p></li><li>查看当前java进程<br>jsp<br>#输出如下<br>4918 ResourceManager<br>1663 NameNode<br>1950 SecondaryNameNode<br>5010 NodeManager<br>5218 Jps<br>1759 DataNode</li><li><p>运行你的mapReduce程序</p></li><li><p>配置好如上配置再运行mapReduce程序时即是yarn中运行。</p></li><li><p>使用web查看Yarn运行状态<br><a href="http://你的服务器ip地址:8088/" target="_blank" rel="noopener">http://你的服务器ip地址:8088/</a></p><h3 id="HDFS常用命令"><a href="#HDFS常用命令" class="headerlink" title="HDFS常用命令"></a>HDFS常用命令</h3></li><li>创建HDFS文件夹</li><li>在根目录创建input文件夹<br>hdfs dfs -mkdir -p /input</li><li>在用户目录创建input文件夹<br>说明：如果不指定“/目录”，则默认在用户目录创建文件夹<br>hdfs dfs -mkdir -p input<br>#等同于 hdfs dfs -mkdir -p /user/hadoop/input</li><li>查看HDFS文件夹</li><li>查看HDFS根文件夹<br>hdfs  dfs  -ls /</li><li>查看HDFS用户目录文件夹<br>hdfs  dfs  -ls</li><li>查看HDFS用户目录文件夹下input文件夹<br>hdfs  dfs  -ls input<br>#等同与 hdfs  dfs  -ls /user/hadoop/input</li><li>复制文件到HDFS<br>hdfs dfs -put /usr/hadoop/etc/hadoop input</li><li>删除文件夹<br>hdfs  dfs  -rm -r input</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;设置固定IP地址及网关&quot;&gt;&lt;a href=&quot;#设置固定IP地址及网关&quot; class=&quot;headerlink&quot; title=&quot;设置固定IP地址及网关&quot;&gt;&lt;/a&gt;设置固定IP地址及网关&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;设置IP&lt;/p&gt;
&lt;figure class=&quot;h
      
    
    </summary>
    
      <category term="搭建" scheme="http://www.wenchong.top/categories/%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="ambari" scheme="http://www.wenchong.top/tags/ambari/"/>
    
  </entry>
  
  <entry>
    <title>hive参数优化</title>
    <link href="http://www.wenchong.top/2017/08/29/hive%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96/"/>
    <id>http://www.wenchong.top/2017/08/29/hive参数优化/</id>
    <published>2017-08-28T16:00:00.000Z</published>
    <updated>2018-02-18T17:03:39.661Z</updated>
    
    <content type="html"><![CDATA[<h3 id="只记录那二年踏过的坑"><a href="#只记录那二年踏过的坑" class="headerlink" title="只记录那二年踏过的坑"></a>只记录那二年踏过的坑</h3><ul><li>1.设置合理solt数<br>mapred.tasktracker.map.tasks.maximum<br>每个tasktracker可同时运行的最大map task数，默认值2。<br>mapred.tasktracker.reduce.tasks.maximum<br>每个tasktracker可同时运行的最大reduce task数，默认值1</li><li>2.配置磁盘块<br>mapred.local.dir<br>map task中间结果写本地磁盘路径，默认值${hadoop.tmp.dir}/mapred/local。<br>可配置多块磁盘缓解写压力。当存在多个可以磁盘时，Hadoop将采用轮询方式将不同的map task中间结果写到磁盘上。</li><li>3.配置RPC Handler数<br>mapred.job.tracker.handler.count<br>jobtracker可并发处理来自tasktracker的RPC请求数，默认值10。</li><li>4.配置HTTP线程数<br>tasktracker.http.threads<br>HTTP服务器的工作线程数，用于获取map task的输出结果，默认值40。</li><li>5.启用批调度</li><li>6.选择合适的压缩算法<br>Job输出结果是否压缩<br>mapred.output.compress<br>是否压缩，默认值false。<br>mapred.output.compression.type<br>压缩类型，有NONE, RECORD和BLOCK，默认值RECORD。<br>mapred.output.compression.codec<br>压缩算法，默认值org.apache.hadoop.io.compress.DefaultCodec。<br>map task输出是否压缩<br>mapred.compress.map.output<br>是否压缩，默认值false<br>mapred.map.output.compression.codec<br>压缩算法，默认值org.apache.hadoop.io.compress.DefaultCodec。</li><li>7.设置失败容忍度<br>mapred.max.map.failures.percent<br>例如：set mapred.max.map.failures.percent=30;<br>作业最多允许失败的map task比例，默认值0。<br>mapred.max.reduce.failures.percent<br>作业最多允许失败的reduce task比例，默认值0。<br>mapred.map.max.attempts<br>一个map task的最多重试次数，默认值4。<br>mapred.reduce.max.attempts<br>一个reduce task的最多重试次数，默认值4。</li><li>8.设置跳过坏记录<br>mapred.skip.attempts.to.start.skipping<br>当任务失败次数达到该值时，启用跳过坏记录功能，默认值2。</li></ul><p>mapred.skip.out.dir<br>检测出的坏记录存放目录，默认值为输出目录的_logs/skip，设置为none表示不输出。<br>mapred.skip.map.max.skip.records<br>map task最多允许的跳过记录数，默认值0。<br>mapred.skip.reduce.max.skip.groups<br>reduce task最多允许的跳过记录数，默认值0。</p><ul><li>9.配置jvm重用<br>mapred.job.reuse.jvm.num.tasks<br>一个jvm可连续启动多个同类型任务，默认值1，若为-1表示不受限制。</li><li>10.配置jvm参数<br>mapred.child.java.opts<br>任务启动的jvm参数，默认值-Xmx200m，建议值-XX:-UseGCOverheadLimit -Xms512m -Xmx2048m -verbose:gc -Xloggc:/tmp/@taskid@.gc</li><li><ol><li>map task调优<br>io.sort.mb<br>默认值100M<br>io.sort.record.percent<br>默认值0.05<br>io.sort.spill.percent<br>默认值0.80</li></ol></li><li>12.reduce task调优<br>io.sort.factor<br>默认值10<br>mapred.reduce.parallel.copies<br>默认值5</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;只记录那二年踏过的坑&quot;&gt;&lt;a href=&quot;#只记录那二年踏过的坑&quot; class=&quot;headerlink&quot; title=&quot;只记录那二年踏过的坑&quot;&gt;&lt;/a&gt;只记录那二年踏过的坑&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;1.设置合理solt数&lt;br&gt;mapred.tasktracke
      
    
    </summary>
    
      <category term="hive" scheme="http://www.wenchong.top/categories/hive/"/>
    
    
      <category term="Hhive" scheme="http://www.wenchong.top/tags/Hhive/"/>
    
  </entry>
  
  <entry>
    <title>kafka参数优化</title>
    <link href="http://www.wenchong.top/2017/08/25/kafka%E4%BC%98%E5%8C%96%E5%8F%82%E6%95%B0/"/>
    <id>http://www.wenchong.top/2017/08/25/kafka优化参数/</id>
    <published>2017-08-24T16:00:00.000Z</published>
    <updated>2018-02-18T17:04:52.386Z</updated>
    
    <content type="html"><![CDATA[<h3 id="只记录那二年踏过的坑"><a href="#只记录那二年踏过的坑" class="headerlink" title="只记录那二年踏过的坑"></a>只记录那二年踏过的坑</h3><ul><li><p>非负整数，用于唯一标识broker<br>broker.id=0</p></li><li><p>broker 服务监听端口<br>port=9092</p></li><li><p>broker 发布给生产者消费者的hostname，会存储在zookeeper。配置好这个host可以实现内网外网同时访问。<br>advertised.host.name=host1</p></li><li><p>broker 发布给生产者消费者的port，会存储在zookeeper。<br>advertised.port=9092</p></li><li><p>处理网络请求的线程数量，一般默认配置就好<br>num.network.threads=3</p></li><li><p>处理磁盘的线程数量，一般默认配置就好<br>num.io.threads=8</p></li><li><p>socket server 发送数据缓冲区大小<br>socket.send.buffer.bytes=102400</p></li><li><p>socket server 接受数据缓冲区大小<br>socket.receive.buffer.bytes=102400</p></li><li><p>soket server 可接受最大消息大小，防止oom<br>socket.request.max.bytes=104857600</p></li><li><p>kafka存放消息的目录<br>log.dirs=/home/data/kafka/kafka-logs</p></li><li><p>每个topic默认partition数量，根据消费者实际情况配置，配置过小会影响消费性能<br>num.partitions=50</p></li><li><p>kafka启动恢复日志,关闭前日志刷盘的线程数<br>num.recovery.threads.per.data.dir=1</p></li><li><p>日志保留时间<br>log.retention.minutes=30</p></li><li><p>日志保留大小<br>log.retention.bytes=53687091200</p></li><li><p>日志 segment file 大小. 超过这个大小创建新segment file<br>log.segment.bytes=67108864</p></li><li><p>日志 segment file 刷新时间. 超过这个时间创建新segment file<br>log.roll.hours=24</p></li><li><p>日志淘汰检查间隔时间<br>log.retention.check.interval.ms=10000</p></li><li><p>Zookeeper host和port<br>zookeeper.connect=localhost:2181</p></li><li><p>连接zookeeper超时时间<br>zookeeper.connection.timeout.ms=6000</p></li><li><p>清除fetch  purgatory 间隔消息条数<br>fetch.purgatory.purge.interval.requests=100</p></li><li><p>清除producer purgatory 间隔消息条数<br>producer .purgatory.purge.interval.requests=100</p></li><li><p>是否可以通过管理工具删除topic，默认是false<br>delete.topic.enable=true</p></li><li><p>日志传输时候的压缩格式，可选择lz4, snappy, gzip,不压缩。建议打开压缩，可以提高传输性能，压缩格式的选择可以参考文章结尾的参考资料。<br>compression.type=snappy</p></li><li><p>启用压缩的topic名称。若上面参数选择了一个压缩格式，那么压缩仅对本参数指定的topic有效，若本参数为空，则对所有topic有效。<br>compressed.topics=topic1</p></li><li><p>用来从主partion同步数据的线程数，默认为1，建议适当调大，数据量大的时候一个同步线程可能不够用<br>num.replica.fetchers=3</p></li><li><p>消息日志备份因子，默认是1<br>default.replication.factor=2</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;只记录那二年踏过的坑&quot;&gt;&lt;a href=&quot;#只记录那二年踏过的坑&quot; class=&quot;headerlink&quot; title=&quot;只记录那二年踏过的坑&quot;&gt;&lt;/a&gt;只记录那二年踏过的坑&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;非负整数，用于唯一标识broker&lt;br&gt;broker.i
      
    
    </summary>
    
      <category term="kafka" scheme="http://www.wenchong.top/categories/kafka/"/>
    
    
      <category term="kafka" scheme="http://www.wenchong.top/tags/kafka/"/>
    
  </entry>
  
  <entry>
    <title>Hbase手动优化</title>
    <link href="http://www.wenchong.top/2017/08/20/hbase%E6%89%8B%E5%8A%A8%E4%BC%98%E5%8C%96/"/>
    <id>http://www.wenchong.top/2017/08/20/hbase手动优化/</id>
    <published>2017-08-19T16:00:00.000Z</published>
    <updated>2018-02-18T17:03:07.306Z</updated>
    
    <content type="html"><![CDATA[<h3 id="只记录那二年踏过的坑"><a href="#只记录那二年踏过的坑" class="headerlink" title="只记录那二年踏过的坑"></a>只记录那二年踏过的坑</h3><h2 id="配置优化"><a href="#配置优化" class="headerlink" title="配置优化"></a>配置优化</h2><ul><li><p>zookeeper.session.timeout<br>默认值：3分钟（180000ms）<br>说明：RegionServer与Zookeeper间的连接超时时间。当超时时间到后，ReigonServer会被Zookeeper从RS集群清单中移除，HMaster收到移除通知后，会对这台server负责的regions重新balance，让其他存活的* RegionServer接管.<br>调优：<br>这个timeout决定了RegionServer是否能够及时的failover。设置成1分钟或更低，可以减少因等待超时而被延长的failover时间。<br>不过需要注意的是，对于一些Online应用，RegionServer从宕机到恢复时间本身就很短的（网络闪断，crash等故障，运维可快速介入），如果调低timeout时间，反而会得不偿失。因为当ReigonServer被正式从RS集群中移除时，HMaster就开始做balance了（让其他RS根据故障机器记录的WAL日志进行恢复）。当故障的RS在人工介入恢复后，这个balance动作是毫无意义的，反而会使负载不均匀，给RS带来更多负担。特别是那些固定分配regions的场景。</p></li><li><p>Hbase.zookeeper.quorum<br>默认值：localhost<br>说明：hbase所依赖的zookeeper部署<br>调优：<br>部署的zookeeper越多，可靠性就越高，但是部署只能部署奇数个，主要为了便于选出leader。最好给每个zookeeper 1G的内存和独立的磁盘，可以确保高性能。hbase.zookeeper.property.dataDir可以修改zookeeper保存数据的路径。</p></li><li><p>hbase.regionserver.handler.count<br>默认值：10<br>说明：RegionServer的请求处理IO线程数。<br>调优：<br>这个参数的调优与内存息息相关。<br>较少的IO线程，适用于处理单次请求内存消耗较高的Big PUT场景（大容量单次PUT或设置了较大cache的scan，均属于Big PUT）或ReigonServer的内存比较紧张的场景。<br>较多的IO线程，适用于单次请求内存消耗低，TPS要求非常高的场景。设置该值的时候，以监控内存为主要参考。<br>这里需要注意的是如果server的region数量很少，大量的请求都落在一个region上，因快速充满memstore触发flush导致的读写锁会影响全局TPS，不是IO线程数越高越好。<br>压测时，开启Enabling RPC-level logging，可以同时监控每次请求的内存消耗和GC的状况，最后通过多次压测结果来合理调节IO线程数。<br>这里是一个案例?Hadoop and HBase Optimization for Read Intensive Search Applications，作者在SSD的机器上设置IO线程数为100，仅供参考。</p></li><li><p>hbase.hregion.max.filesize<br>默认值：256M<br>说明：在当前ReigonServer上单个Reigon的最大存储空间，单个Region超过该值时，这个Region会被自动split成更小的region。<br>调优：<br>小region对split和compaction友好，因为拆分region或compact小region里的storefile速度很快，内存占用低。缺点是split和compaction会很频繁。<br>特别是数量较多的小region不停地split, compaction，会导致集群响应时间波动很大，region数量太多不仅给管理上带来麻烦，甚至会引发一些Hbase的bug。<br>一般512以下的都算小region。</p></li></ul><p>大region，则不太适合经常split和compaction，因为做一次compact和split会产生较长时间的停顿，对应用的读写性能冲击非常大。此外，大region意味着较大的storefile，compaction时对内存也是一个挑战。<br>当然，大region也有其用武之地。如果你的应用场景中，某个时间点的访问量较低，那么在此时做compact和split，既能顺利完成split和compaction，又能保证绝大多数时间平稳的读写性能。</p><p>既然split和compaction如此影响性能，有没有办法去掉？<br>compaction是无法避免的，split倒是可以从自动调整为手动。<br>只要通过将这个参数值调大到某个很难达到的值，比如100G，就可以间接禁用自动split（RegionServer不会对未到达100G的region做split）。<br>再配合RegionSplitter这个工具，在需要split时，手动split。<br>手动split在灵活性和稳定性上比起自动split要高很多，相反，管理成本增加不多，比较推荐online实时系统使用。</p><p>内存方面，小region在设置memstore的大小值上比较灵活，大region则过大过小都不行，过大会导致flush时app的IO wait增高，过小则因store file过多影响读性能。</p><ul><li><p>hbase.regionserver.global.memstore.upperLimit/lowerLimit<br>默认值：0.4/0.35<br>upperlimit说明：hbase.hregion.memstore.flush.size 这个参数的作用是当单个Region内所有的memstore大小总和超过指定值时，flush该region的所有memstore。RegionServer的flush是通过将请求添加一个队列，模拟生产消费模式来异步处理的。那这里就有一个问题，当队列来不及消费，产生大量积压请求时，可能会导致内存陡增，最坏的情况是触发OOM。<br>这个参数的作用是防止内存占用过大，当ReigonServer内所有region的memstores所占用内存总和达到heap的40%时，HBase会强制block所有的更新并flush这些region以释放所有memstore占用的内存。<br>lowerLimit说明： 同upperLimit，只不过lowerLimit在所有region的memstores所占用内存达到Heap的35%时，不flush所有的memstore。它会找一个memstore内存占用最大的region，做个别flush，此时写更新还是会被block。lowerLimit算是一个在所有region强制flush导致性能降低前的补救措施。在日志中，表现为 “** Flush thread woke up with memory above low water.”<br>调优：这是一个Heap内存保护参数，默认值已经能适用大多数场景。<br>参数调整会影响读写，如果写的压力大导致经常超过这个阀值，则调小读缓存hfile.block.cache.size增大该阀值，或者Heap余量较多时，不修改读缓存大小。<br>如果在高压情况下，也没超过这个阀值，那么建议你适当调小这个阀值再做压测，确保触发次数不要太多，然后还有较多Heap余量的时候，调大hfile.block.cache.size提高读性能。<br>还有一种可能性是?hbase.hregion.memstore.flush.size保持不变，但RS维护了过多的region，要知道 region数量直接影响占用内存的大小。</p></li><li><p>hfile.block.cache.size</p></li></ul><p>默认值：0.2<br>说明：storefile的读缓存占用Heap的大小百分比，0.2表示20%。该值直接影响数据读的性能。<br>调优：当然是越大越好，如果写比读少很多，开到0.4-0.5也没问题。如果读写较均衡，0.3左右。如果写比读多，果断默认吧。设置这个值的时候，你同时要参考?hbase.regionserver.global.memstore.upperLimit?，该值是memstore占heap的最大百分比，两个参数一个影响读，一个影响写。如果两值加起来超过80-90%，会有OOM的风险，谨慎设置。</p><ul><li><p>hbase.hstore.blockingStoreFiles<br>默认值：7<br>说明：在flush时，当一个region中的Store（Coulmn Family）内有超过7个storefile时，则block所有的写请求进行compaction，以减少storefile数量。<br>调优：block写请求会严重影响当前regionServer的响应时间，但过多的storefile也会影响读性能。从实际应用来看，为了获取较平滑的响应时间，可将值设为无限大。如果能容忍响应时间出现较大的波峰波谷，那么默认或根据自身场景调整即可。</p></li><li><p>hbase.hregion.memstore.block.multiplier<br>默认值：2<br>说明：当一个region里的memstore占用内存大小超过hbase.hregion.memstore.flush.size两倍的大小时，block该region的所有请求，进行flush，释放内存。<br>虽然我们设置了region所占用的memstores总内存大小，比如64M，但想象一下，在最后63.9M的时候，我Put了一个200M的数据，此时memstore的大小会瞬间暴涨到超过预期的hbase.hregion.memstore.flush.size的几倍。这个参数的作用是当memstore的大小增至超过hbase.hregion.memstore.flush.size 2倍时，block所有请求，遏制风险进一步扩大。<br>调优： 这个参数的默认值还是比较靠谱的。如果你预估你的正常应用场景（不包括异常）不会出现突发写或写的量可控，那么保持默认值即可。如果正常情况下，你的写请求量就会经常暴长到正常的几倍，那么你应该调大这个倍数并调整其他参数值，比如hfile.block.cache.size和hbase.regionserver.global.memstore.upperLimit/lowerLimit，以预留更多内存，防止HBase server OOM。</p></li><li><p>hbase.hregion.memstore.mslab.enabled<br>默认值：true<br>说明：减少因内存碎片导致的Full GC，提高整体性能。<br>调优：详见 <a href="http://kenwublog.com/avoid-full-gc-in-hbase-using-arena-allocation" target="_blank" rel="noopener">http://kenwublog.com/avoid-full-gc-in-hbase-using-arena-allocation</a></p></li><li><p>hbase.client.scanner.caching<br>默认值：1<br>说明：scanner调用next方法一次获取的数据条数<br>调优：少的RPC是提高hbase执行效率的一种方法，理论上一次性获取越多数据就会越少的RPC，也就越高效。但是内存是最大的障碍。设置这个值的时候要选择合适的大小，一面一次性获取过多数据占用过多内存，造成其他程序使用内存过少。或者造成程序超时等错误（这个超时与hbase.regionserver.lease.period相关）。</p></li><li><p>hbase.regionserver.lease.period<br>默认值：60000<br>说明：客户端租用HRegion server 期限，即超时阀值。<br>调优：<br>这个配合hbase.client.scanner.caching使用，如果内存够大，但是取出较多数据后计算过程较长，可能超过这个阈值，适当可设置较长的响应时间以防被认为宕机。</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;只记录那二年踏过的坑&quot;&gt;&lt;a href=&quot;#只记录那二年踏过的坑&quot; class=&quot;headerlink&quot; title=&quot;只记录那二年踏过的坑&quot;&gt;&lt;/a&gt;只记录那二年踏过的坑&lt;/h3&gt;&lt;h2 id=&quot;配置优化&quot;&gt;&lt;a href=&quot;#配置优化&quot; class=&quot;head
      
    
    </summary>
    
      <category term="Hbase" scheme="http://www.wenchong.top/categories/Hbase/"/>
    
    
      <category term="Hbase" scheme="http://www.wenchong.top/tags/Hbase/"/>
    
  </entry>
  
  <entry>
    <title>MapReduce参数优化</title>
    <link href="http://www.wenchong.top/2017/08/19/MapReduce%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96/"/>
    <id>http://www.wenchong.top/2017/08/19/MapReduce参数优化/</id>
    <published>2017-08-18T16:00:00.000Z</published>
    <updated>2018-02-18T17:05:07.503Z</updated>
    
    <content type="html"><![CDATA[<h3 id="只记录那二年踏过的坑"><a href="#只记录那二年踏过的坑" class="headerlink" title="只记录那二年踏过的坑"></a>只记录那二年踏过的坑</h3><h2 id="1-core-default-xml："><a href="#1-core-default-xml：" class="headerlink" title="1 core-default.xml："></a>1 core-default.xml：</h2><ul><li>hadoop.tmp.dir：</li></ul><p>默认值： /tmp<br>说明： 尽量手动配置这个选项，否则的话都默认存在了里系统的默认临时文件/tmp里。并且手动配置的时候，如果服务器是多磁盘的，每个磁盘都设置一个临时文件目录，这样便于mapreduce或者hdfs等使用的时候提高磁盘IO效率。</p><ul><li>fs.trash.interval：</li></ul><p>默认值： 0<br>说明： 这个是开启hdfs文件删除自动转移到垃圾箱的选项，值为垃圾箱文件清除时间。一般开启这个会比较好，以防错误删除重要文件。单位是分钟。</p><ul><li>io.file.buffer.size：</li></ul><p>默认值：4096<br>说明：SequenceFiles在读写中可以使用的缓存大小，可减少 I/O 次数。在大型的 Hadoop cluster，建议可设定为 65536 到 131072。</p><h2 id="2-hdfs-default-xml："><a href="#2-hdfs-default-xml：" class="headerlink" title="2 hdfs-default.xml："></a>2 hdfs-default.xml：</h2><ul><li>dfs.blocksize：</li></ul><p>默认值：134217728<br>说明： 这个就是hdfs里一个文件块的大小了，CDH5中默认128M。太大的话会有较少map同时计算，太小的话也浪费可用map个数资源，而且文件太小namenode就浪费内存多。根据需要进行设置。</p><ul><li>dfs.namenode.handler.count：</li></ul><p>默认值：10<br>说明：设定 namenode server threads 的数量，这些 threads 會用 RPC 跟其他的 datanodes 沟通。当 datanodes 数量太多时会发現很容易出現 RPC timeout，解決方法是提升网络速度或提高这个值，但要注意的是 thread 数量多也表示 namenode 消耗的内存也随着增加</p><h2 id="3-mapred-default-xml："><a href="#3-mapred-default-xml：" class="headerlink" title="3 mapred-default.xml："></a>3 mapred-default.xml：</h2><ul><li>mapred.reduce.tasks（mapreduce.job.reduces）：</li></ul><p>默认值：1<br>说明：默认启动的reduce数。通过该参数可以手动修改reduce的个数。</p><ul><li>mapreduce.task.io.sort.factor：</li></ul><p>默认值：10<br>说明：Reduce Task中合并小文件时，一次合并的文件数据，每次合并的时候选择最小的前10进行合并。</p><ul><li>mapreduce.task.io.sort.mb：</li></ul><p>默认值：100<br>说明： Map Task缓冲区所占内存大小。</p><ul><li>mapred.child.java.opts：</li></ul><p>默认值：-Xmx200m<br>说明：jvm启动的子线程可以使用的最大内存。建议值-XX:-UseGCOverheadLimit -Xms512m -Xmx2048m -verbose:gc -Xloggc:/tmp/@taskid@.gc</p><ul><li>mapreduce.jobtracker.handler.count：</li></ul><p>默认值：10<br>说明：JobTracker可以启动的线程数，一般为tasktracker节点的4%。</p><ul><li>mapreduce.reduce.shuffle.parallelcopies：</li></ul><p>默认值：5<br>说明：reuduce shuffle阶段并行传输数据的数量。这里改为10。集群大可以增大。</p><ul><li>mapreduce.tasktracker.http.threads：</li></ul><p>默认值：40<br>说明：map和reduce是通过http进行数据传输的，这个是设置传输的并行线程数。</p><ul><li>mapreduce.map.output.compress：</li></ul><p>默认值：false<br>说明： map输出是否进行压缩，如果压缩就会多耗cpu，但是减少传输时间，如果不压缩，就需要较多的传输带宽。配合 mapreduce.map.output.compress.codec使用，默认是 org.apache.hadoop.io.compress.DefaultCodec，可以根据需要设定数据压缩方式。</p><ul><li>mapreduce.reduce.shuffle.merge.percent：</li></ul><p>默认值： 0.66<br>说明：reduce归并接收map的输出数据可占用的内存配置百分比。类似mapreduce.reduce.shuffle.input.buffer.percen属性。</p><ul><li>mapreduce.reduce.shuffle.memory.limit.percent：</li></ul><p>默认值： 0.25<br>说明：一个单一的shuffle的最大内存使用限制。</p><ul><li>mapreduce.jobtracker.handler.count：</li></ul><p>默认值： 10<br>说明：可并发处理来自tasktracker的RPC请求数，默认值10。</p><ul><li>mapred.job.reuse.jvm.num.tasks（mapreduce.job.jvm.numtasks）：</li></ul><p>默认值： 1<br>说明：一个jvm可连续启动多个同类型任务，默认值1，若为-1表示不受限制。</p><ul><li>mapreduce.tasktracker.tasks.reduce.maximum：</li></ul><p>默认值： 2<br>说明：一个tasktracker并发执行的reduce数，建议为cpu核数</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;只记录那二年踏过的坑&quot;&gt;&lt;a href=&quot;#只记录那二年踏过的坑&quot; class=&quot;headerlink&quot; title=&quot;只记录那二年踏过的坑&quot;&gt;&lt;/a&gt;只记录那二年踏过的坑&lt;/h3&gt;&lt;h2 id=&quot;1-core-default-xml：&quot;&gt;&lt;a href=&quot;#1-
      
    
    </summary>
    
      <category term="MapReduce" scheme="http://www.wenchong.top/categories/MapReduce/"/>
    
    
      <category term="MapReduce" scheme="http://www.wenchong.top/tags/MapReduce/"/>
    
  </entry>
  
  <entry>
    <title>amabri卸载</title>
    <link href="http://www.wenchong.top/2017/08/10/ambari%E5%8D%B8%E8%BD%BD/"/>
    <id>http://www.wenchong.top/2017/08/10/ambari卸载/</id>
    <published>2017-08-09T16:00:00.000Z</published>
    <updated>2018-05-18T14:10:17.055Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-删除hdp-repo和hdp-util-repo"><a href="#1-删除hdp-repo和hdp-util-repo" class="headerlink" title="1.删除hdp.repo和hdp-util.repo"></a>1.删除hdp.repo和hdp-util.repo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/yum.repos.d/</span><br><span class="line">rm -rf hdp*</span><br><span class="line">rm -rf HDP*</span><br><span class="line">rm -rf ambari*</span><br></pre></td></tr></table></figure><h2 id="2-删除安装包"><a href="#2-删除安装包" class="headerlink" title="2.删除安装包"></a>2.删除安装包</h2><p>用yum list installed | grep HDP来检查安装的ambari的包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">yum remove -y  sqoop.noarch  </span><br><span class="line">yum remove -y  lzo-devel.x86_64  </span><br><span class="line">yum remove -y  hadoop-libhdfs.x86_64  </span><br><span class="line">yum remove -y  rrdtool.x86_64  </span><br><span class="line">yum remove -y  hbase.noarch  </span><br><span class="line">yum remove -y  pig.noarch  </span><br><span class="line">yum remove -y  lzo.x86_64  </span><br><span class="line">yum remove -y  ambari-log4j.noarch  </span><br><span class="line">yum remove -y  oozie.noarch  </span><br><span class="line">yum remove -y  oozie-client.noarch  </span><br><span class="line">yum remove -y  gweb.noarch  </span><br><span class="line">yum remove -y  snappy-devel.x86_64  </span><br><span class="line">yum remove -y  hcatalog.noarch  </span><br><span class="line">yum remove -y  python-rrdtool.x86_64  </span><br><span class="line">yum remove -y  nagios.x86_64  </span><br><span class="line">yum remove -y  webhcat-tar-pig.noarch  </span><br><span class="line">yum remove -y  snappy.x86_64  </span><br><span class="line">yum remove -y  libconfuse.x86_64    </span><br><span class="line">yum remove -y  webhcat-tar-hive.noarch  </span><br><span class="line">yum remove -y  ganglia-gmetad.x86_64  </span><br><span class="line">yum remove -y  extjs.noarch  </span><br><span class="line">yum remove -y  hive.noarch  </span><br><span class="line">yum remove -y  hadoop-lzo.x86_64  </span><br><span class="line">yum remove -y  hadoop-lzo-native.x86_64  </span><br><span class="line">yum remove -y  hadoop-native.x86_64  </span><br><span class="line">yum remove -y  hadoop-pipes.x86_64  </span><br><span class="line">yum remove -y  nagios-plugins.x86_64  </span><br><span class="line">yum remove -y  hadoop.x86_64  </span><br><span class="line">yum remove -y  zookeeper.noarch      </span><br><span class="line">yum remove -y  hadoop-sbin.x86_64  </span><br><span class="line">yum remove -y  ganglia-gmond.x86_64  </span><br><span class="line">yum remove -y  libganglia.x86_64  </span><br><span class="line">yum remove -y  perl-rrdtool.x86_64</span><br><span class="line">yum remove -y  epel-release.noarch</span><br><span class="line">yum remove -y  compat-readline5*</span><br><span class="line">yum remove -y  fping.x86_64</span><br><span class="line">yum remove -y  perl-Crypt-DES.x86_64</span><br><span class="line">yum remove -y  exim.x86_64</span><br><span class="line">yum remove -y ganglia-web.noarch</span><br><span class="line">yum remove -y perl-Digest-HMAC.noarch</span><br><span class="line">yum remove -y perl-Digest-SHA1.x86_64</span><br><span class="line">yum remove -y bigtop-jsvc.x86_64</span><br></pre></td></tr></table></figure></p><h2 id="3-删除快捷方式"><a href="#3-删除快捷方式" class="headerlink" title="3.删除快捷方式"></a>3.删除快捷方式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/alternatives</span><br><span class="line">rm -rf hadoop-etc </span><br><span class="line">rm -rf zookeeper-conf </span><br><span class="line">rm -rf hbase-conf </span><br><span class="line">rm -rf hadoop-log </span><br><span class="line">rm -rf hadoop-lib </span><br><span class="line">rm -rf hadoop-default </span><br><span class="line">rm -rf oozie-conf </span><br><span class="line">rm -rf hcatalog-conf </span><br><span class="line">rm -rf hive-conf </span><br><span class="line">rm -rf hadoop-man </span><br><span class="line">rm -rf sqoop-conf </span><br><span class="line">rm -rf hadoop-conf</span><br></pre></td></tr></table></figure><h2 id="4-删除用户"><a href="#4-删除用户" class="headerlink" title="4.删除用户"></a>4.删除用户</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">userdel nagios </span><br><span class="line">userdel hive </span><br><span class="line">userdel ambari-qa </span><br><span class="line">userdel hbase </span><br><span class="line">userdel oozie </span><br><span class="line">userdel hcat </span><br><span class="line">userdel mapred </span><br><span class="line">userdel hdfs </span><br><span class="line">userdel rrdcached </span><br><span class="line">userdel zookeeper </span><br><span class="line">#userdel mysql </span><br><span class="line">userdel sqoop</span><br><span class="line">userdel puppet</span><br><span class="line">userdel yarn</span><br><span class="line">userdel tez</span><br><span class="line">userdel hadoop</span><br><span class="line">userdel knox</span><br><span class="line">userdel storm</span><br><span class="line">userdel falcon</span><br><span class="line">userdel flume</span><br><span class="line">userdel nagios</span><br><span class="line">userdel admin</span><br><span class="line">userdel postgres</span><br><span class="line">userdel  hdfs</span><br><span class="line">userdel  zookeeper</span><br><span class="line">userdel hbase</span><br></pre></td></tr></table></figure><h2 id="5-删除文件夹"><a href="#5-删除文件夹" class="headerlink" title="5.删除文件夹"></a>5.删除文件夹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /hadoop</span><br><span class="line">rm -rf /etc/hadoop </span><br><span class="line">rm -rf /etc/hbase </span><br><span class="line">rm -rf /etc/hcatalog </span><br><span class="line">rm -rf /etc/hive </span><br><span class="line">rm -rf /etc/ganglia </span><br><span class="line">rm -rf /etc/nagios </span><br><span class="line">rm -rf /etc/oozie </span><br><span class="line">rm -rf /etc/sqoop </span><br><span class="line">rm -rf /etc/zookeeper </span><br><span class="line">rm -rf /var/run/hadoop </span><br><span class="line">rm -rf /var/run/hbase </span><br><span class="line">rm -rf /var/run/hive </span><br><span class="line">rm -rf /var/run/ganglia </span><br><span class="line">rm -rf /var/run/nagios </span><br><span class="line">rm -rf /var/run/oozie</span><br><span class="line">rm -rf /var/run/zookeeper</span><br><span class="line">rm -rf /var/log/hadoop </span><br><span class="line">rm -rf /var/log/hbase </span><br><span class="line">rm -rf /var/log/hive </span><br><span class="line">rm -rf /var/log/nagios </span><br><span class="line">rm -rf /var/log/oozie </span><br><span class="line">rm -rf /var/log/zookeeper </span><br><span class="line">rm -rf /usr/lib/hadoop</span><br><span class="line">rm -rf /usr/lib/hbase </span><br><span class="line">rm -rf /usr/lib/hcatalog </span><br><span class="line">rm -rf /usr/lib/hive </span><br><span class="line">rm -rf /usr/lib/oozie </span><br><span class="line">rm -rf /usr/lib/sqoop </span><br><span class="line">rm -rf /usr/lib/zookeeper </span><br><span class="line">rm -rf /var/lib/hive </span><br><span class="line">rm -rf /var/lib/ganglia </span><br><span class="line">rm -rf /var/lib/oozie </span><br><span class="line">rm -rf /var/lib/zookeeper </span><br><span class="line">rm -rf /var/tmp/oozie </span><br><span class="line">rm -rf /tmp/hive </span><br><span class="line">rm -rf /tmp/nagios </span><br><span class="line">rm -rf /tmp/ambari-qa </span><br><span class="line">rm -rf /tmp/sqoop-ambari-qa </span><br><span class="line">rm -rf /var/nagios </span><br><span class="line">rm -rf /hadoop/oozie </span><br><span class="line">rm -rf /hadoop/zookeeper </span><br><span class="line">rm -rf /hadoop/mapred </span><br><span class="line">rm -rf /hadoop/hdfs </span><br><span class="line">rm -rf /tmp/hadoop-hive </span><br><span class="line">rm -rf /tmp/hadoop-nagios </span><br><span class="line">rm -rf /tmp/hadoop-hcat </span><br><span class="line">rm -rf /tmp/hadoop-ambari-qa </span><br><span class="line">rm -rf /tmp/hsperfdata_hbase </span><br><span class="line">rm -rf /tmp/hsperfdata_hive </span><br><span class="line">rm -rf /tmp/hsperfdata_nagios </span><br><span class="line">rm -rf /tmp/hsperfdata_oozie </span><br><span class="line">rm -rf /tmp/hsperfdata_zookeeper </span><br><span class="line">rm -rf /tmp/hsperfdata_mapred </span><br><span class="line">rm -rf /tmp/hsperfdata_hdfs </span><br><span class="line">rm -rf /tmp/hsperfdata_hcat </span><br><span class="line">rm -rf /tmp/hsperfdata_ambari-qa</span><br><span class="line">rm -rf /etc/flume</span><br><span class="line">rm -rf /etc/storm</span><br><span class="line">rm -rf /etc/hive-hcatalog</span><br><span class="line">rm -rf /etc/tez</span><br><span class="line">rm -rf /etc/falcon</span><br><span class="line">rm -rf /var/run/flume</span><br><span class="line">rm -rf /var/run/storm</span><br><span class="line">rm -rf /var/run/webhcat</span><br><span class="line">rm -rf /var/run/hadoop-yarn</span><br><span class="line">rm -rf /var/run/hadoop-mapreduce</span><br><span class="line">rm -rf /var/log/flume</span><br><span class="line">rm -rf /var/log/storm</span><br><span class="line">rm -rf /var/log/hadoop-yarn</span><br><span class="line">rm -rf /var/log/hadoop-mapreduce</span><br><span class="line">rm -rf /usr/lib/nagios</span><br><span class="line">rm -rf /var/lib/hdfs</span><br><span class="line">rm -rf /var/lib/hadoop-hdfs</span><br><span class="line">rm -rf /var/lib/hadoop-yarn</span><br><span class="line">rm -rf /var/lib/hadoop-mapreduce</span><br><span class="line">rm -rf /tmp/hadoop-hdfs</span><br></pre></td></tr></table></figure><h2 id="5-重置数据库，删除ambari包"><a href="#5-重置数据库，删除ambari包" class="headerlink" title="5.重置数据库，删除ambari包"></a>5.重置数据库，删除ambari包</h2><p>#采用这句命令来检查<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list installed | grep ambari</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ambari-server stop</span><br><span class="line">ambari-agent stop</span><br><span class="line">ambari-server reset</span><br><span class="line">yum remove -y ambari-*</span><br><span class="line">yum remove -y postgresql</span><br><span class="line">rm -rf /etc/yum.repos.d/ambari*</span><br><span class="line">rm -rf /var/lib/ambari*</span><br><span class="line">rm -rf /var/log/ambari*</span><br><span class="line">rm -rf /etc/ambari*</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-删除hdp-repo和hdp-util-repo&quot;&gt;&lt;a href=&quot;#1-删除hdp-repo和hdp-util-repo&quot; class=&quot;headerlink&quot; title=&quot;1.删除hdp.repo和hdp-util.repo&quot;&gt;&lt;/a&gt;1.删除hdp.
      
    
    </summary>
    
      <category term="搭建" scheme="http://www.wenchong.top/categories/%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="ambari" scheme="http://www.wenchong.top/tags/ambari/"/>
    
  </entry>
  
  <entry>
    <title>错误及解决方案</title>
    <link href="http://www.wenchong.top/2017/08/10/ambari%E6%90%AD%E5%BB%BA%E9%94%99%E8%AF%AF/"/>
    <id>http://www.wenchong.top/2017/08/10/ambari搭建错误/</id>
    <published>2017-08-09T16:00:00.000Z</published>
    <updated>2018-05-14T06:07:44.326Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR: Exiting with exit code 1. </span><br><span class="line">REASON: Database check failed to complete. Please check /var/log/ambari-server/ambari-server.log and /var/log/ambari-server/ambari-server-check-database.log for more information.</span><br></pre></td></tr></table></figure><p>解决方法：查看日志，具体什么错.例如：数据库未开启、数据库配置问题</p><p>撤销已经赋予给 MySQL 用户权限的权限。<br>revoke 跟 grant 的语法差不多，只需要把关键字 “to” 换成 “from” 即可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">revoke  all on *.* from &apos;root&apos;@&apos;192.168.0.197&apos;;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@datanode01 ~]# yum makecache</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Determining fastest mirrors</span><br><span class="line">ambari-2.4.1.0                                                   | 2.9 kB     00:00     </span><br><span class="line">ambari-2.4.1.0/filelists_db                                      | 139 kB     00:00     </span><br><span class="line">ambari-2.4.1.0/primary_db                                        | 8.3 kB     00:00     </span><br><span class="line">ambari-2.4.1.0/other_db                                          | 1.3 kB     00:00     </span><br><span class="line">file:///mnt/repodata/repomd.xml: [Errno 14] Could not open/read file:///mnt/repodata/repomd.xml</span><br><span class="line">Trying other mirror.</span><br><span class="line">Error: Cannot retrieve repository metadata (repomd.xml) for repository: c6-media. Please verify its path and try again</span><br></pre></td></tr></table></figure><p>如果有后面两个文件，处理方式mv CentOS-Media.repo CentOS-Media.repo.bak<br>没有的话，源问题，换源repos</p><h3 id="tip"><a href="#tip" class="headerlink" title="tip:"></a>tip:</h3><p>1、当提示要做如下操作的时候<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Be?sure?you?have?run:ambari-server?setup?--jdbc-db=mysql?--jdbc-driver=/path/to/mysql/****</span><br></pre></td></tr></table></figure></p><p>需要下载mysql-connector-java-5.1.39.tar驱动，解压得到mysql-connector-java-5.1.39-bin.jar文件<br>执行如下命令：ambari-server?setup?–jdbc-db=mysql?–jdbc-driver=/usr/lib/java/mysql-connector-java-5.1.39/mysql-connector-java-5.1.39-<br>bin.jar<br>同时，设置文件权限为644</p><h3 id="2017-7-19"><a href="#2017-7-19" class="headerlink" title="2017.7.19"></a>2017.7.19</h3><p>1.ERROR namenode.NameNode (NameNode.java:main(1759)) - Failed to start namenode.<br>java.net.BindException: Port in use: datanode01:50070<br>  不能获取映射地址，需要修改hosts中的映射ip为真实ip（ifconfig）<br>2.错删自定义的service导致不能登录amnari UI（日志报出database问题） （百度方案无解，最后重装ambari-server(发现重装无法下手，百度后删除ambari相关组件以及数据库的完全卸载，完成)）<br>3.使用ambari-server启动HDFS时，DataNode无法启动（出现port in use：localhost 0）。解决方式，在hosts文件中localhost 172.0.0.1被#；去除#后解决</p><h3 id="一般故障排除"><a href="#一般故障排除" class="headerlink" title="一般故障排除"></a>一般故障排除</h3><p>Ambari服务器：检查/var/log/ambari-server/ambari-server.[log|out]是否存在错误。<br>Ambari代理：检查/var/log/ambari-agent/ambari-agent.[log|out]是否存在错误。<br>请注意，如果Ambari Agent在/var/log/ambari-agent/ambari-agent.out中有任何输出，则表明存在重大问题。</p><h3 id="服务无法启动"><a href="#服务无法启动" class="headerlink" title="服务无法启动"></a>服务无法启动</h3><p>HDFS：检查/ var / log / hadoop / hdfs下的日志文件<br>MapReduce：检查/ var / log / hadoop / mapred下的日志文件<br>HBase：检查/ var / log / hbase下的日志文件<br>Hive：检查/ var / log / hive下的日志文件<br>Oozie：检查/ var / log / oozie下的日志文件<br>ZooKeeper：检查/ var / log / zookeeper下的日志文件<br>WebHCat：检查/ var / log / webhcat下的日志文件<br>Nagios：检查/ var / log / nagios下的日志文件</p><h3 id="2017-7-20"><a href="#2017-7-20" class="headerlink" title="2017.7.20"></a>2017.7.20</h3><p>Service ‘userhome’ check failed: java.io.FileNotFoundException: File does not exist: /user/admin<br>解决方案：sudo -u hdfs hdfs dfs  -mkdir /user/admin<br>sudo -u hdfs hdfs dfs  -chown admin:hadoop /user/admin</p><h3 id="资源池问题"><a href="#资源池问题" class="headerlink" title="资源池问题"></a>资源池问题</h3><p>FATAL org.apache.hadoop.hdfs.server.datanode.DataNode: Initialization failed forblock pool Block pool BP-1480406410-192.168.1.181-1398701121586 (storage idDS-167510828-192.168.1.191-50010-1398750515421)<br>原因：每次namenode format会重新创建一个namenodeId,而data目录包含了上次format时的id,namenode format清空了namenode下的数据,但是没有清空datanode下的数据,导致启动时失败,所要做的就是每次fotmat前,清空data下的所有目录.<br>: d6 E2 t&amp; M” g7 a* q3 l, H<br>解决办法：停掉集群，删除问题节点的data目录下的所有内容。即hdfs-site.xml文件中配置的dfs.data.dir目录。重新格式化namenode。</p><p>另一个更省事的办法：先停掉集群，然后将datanode节点目录/dfs/data/current/VERSION中的修改为与namenode一致即可。<br>其实我没解决，直接重装</p><h3 id="block-missing问题"><a href="#block-missing问题" class="headerlink" title="block missing问题"></a>block missing问题</h3><p>会导致进入安全模式：处理方式，删除缺失包，在HDFS用户下退出安全模式</p><p>添加节点时，需要查看该节点root磁盘下的剩余大小，如果磁盘空间不足，则扩大磁盘再添加节点。<br>不要问我为什么，说多了都是泪。集群就是这么崩盘的。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;
      
    
    </summary>
    
      <category term="搭建" scheme="http://www.wenchong.top/categories/%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="ambari" scheme="http://www.wenchong.top/tags/ambari/"/>
    
  </entry>
  
  <entry>
    <title>Ambari搭建</title>
    <link href="http://www.wenchong.top/2017/08/09/ambari%E6%90%AD%E5%BB%BA/"/>
    <id>http://www.wenchong.top/2017/08/09/ambari搭建/</id>
    <published>2017-08-08T16:00:00.000Z</published>
    <updated>2018-05-18T14:08:57.870Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-物理条件：三台centos"><a href="#1-物理条件：三台centos" class="headerlink" title="1.物理条件：三台centos"></a>1.物理条件：三台centos</h2><p>前期条件：修改每台centos的名称，分别为namenode、datanode01、datanode02<br>          ssh免密码配置：namenode 可以免密码登录到datanode01、datanode02<br>配置ssh<br>      在namenode上生成密钥对：ssh-keygen  –t  rsa<br>      在/root/.ssh中会有生成的密钥对<br>      将namenode  的 id_rsa.pub写入datanode01的/root/.ssh  authorized_keys文件中。再将datanode01的authorized_keys 写入namenode /root/.ssh<br>datanode02同理操作<br>scp .ssh/id_rsa.pub chenlb@192.168.1.181:/home/chenlb/id_rsa.pub<br>cat id_rsa.pub &gt;&gt; .ssh/authorized_keys<br>  将namenode中的三个机器的私钥 id_rsa提取到桌面，后续使用<br>安装ntp服务<br>yum install ntp<br>service ntpd start<br>chkconfig ntpd on</p><h2 id="2-更换源："><a href="#2-更换源：" class="headerlink" title="2.更换源："></a>2.更换源：</h2><p>将/etc/yum.repos.d/下的原centos.repos备份，然后添加本地源（我这是之前师傅在其他服务器布            置好了的源，你们可在网上查找相关源）</p><h2 id="3-验证本机名"><a href="#3-验证本机名" class="headerlink" title="3.验证本机名"></a>3.验证本机名</h2><pre><code>Hostname   -f</code></pre><p>  显示<br>      namenode   其他两台一样</p><h2 id="4-关闭防火墙"><a href="#4-关闭防火墙" class="headerlink" title="4.关闭防火墙"></a>4.关闭防火墙</h2><pre><code>Service iptables stop</code></pre><p>禁用自启动<br>      Chkconfig   iptables  off</p><h2 id="5-禁用ipv6"><a href="#5-禁用ipv6" class="headerlink" title="5.禁用ipv6"></a>5.禁用ipv6</h2><pre><code>使用lsmod查看系统启动的模块：ipv6相关的模块是net-pf-10  ipv6在vi  /etc/modprobe.d/dist.conf    中最后添加</code></pre><p> alias   net-pf-10   off<br>                                    alias  ipv6   off<br>      重启后，再使用lsmod查看ipv6的相应模块还在不在</p><h2 id="6-禁用SELinux"><a href="#6-禁用SELinux" class="headerlink" title="6.禁用SELinux"></a>6.禁用SELinux</h2><p>配置selinux<br>vi  /etc/sysconfig/selinux<br>插入<br>SELINUX=disabled<br>暂时禁用      setenforce  0</p><h2 id="7-配置禁用THP-每次重启机器后需要从新配置"><a href="#7-配置禁用THP-每次重启机器后需要从新配置" class="headerlink" title="7.配置禁用THP(每次重启机器后需要从新配置)"></a>7.配置禁用THP(每次重启机器后需要从新配置)</h2><p>  查看当前THP状态<br>  cat   /sys/kernel/mm/transparent_hugepage/enabled<br>  如果为always  madvise   [never]则为禁用<br>配置禁用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo  never  &gt;  /sys/kernel/mm/redhat_transparent_hugepage/defrag</span><br><span class="line">echo  never  &gt;  /sys/kernel/mm/redhat_transparent_hugepage/enabled</span><br><span class="line">echo  never  &gt;  /sys/kernel/mm/ transparent_hugepage/defrag</span><br><span class="line">echo  never  &gt;  /sys/kernel/mm/ transparent_hugepage/enabled</span><br></pre></td></tr></table></figure></p><h2 id="8-clean源-重新加载"><a href="#8-clean源-重新加载" class="headerlink" title="8.clean源 重新加载"></a>8.clean源 重新加载</h2><pre><code>yum clean allyum makecache</code></pre><h2 id="9-配置mysql作为数据库（只在ambari-server安装机器上做）"><a href="#9-配置mysql作为数据库（只在ambari-server安装机器上做）" class="headerlink" title="9.配置mysql作为数据库（只在ambari-server安装机器上做）"></a>9.配置mysql作为数据库（只在ambari-server安装机器上做）</h2><p>   查看当前安装数据库信息   rpm  -qa  |   grep   -i   mysql<br>    卸载方法 yum   -y   remove  +name<br>    安装MySQL  查看当前源中是否有提供的MySQL<br>    yum   list  |   grep   mysql<br>    安装mysql-server<br>安装<br>    安装后mysql 只有一个用户root 且第一次开启时需要设置密码，我们这通过命令提前设置                   mysqladmin  -u  root  password  ‘’</p><pre><code>设置为自启动  chkconfig  mysqld  on登录到root用户</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql   -u  root   -p </span><br><span class="line">create  user  ‘amabri’@’% ’    identified   by   ‘bigdata’;</span><br><span class="line">grant   all   privileges   on   *.*    to    ‘ambari’@’%’;</span><br><span class="line">create   user   ‘ambari’@’localhost’   identified   by    ‘bigdata’;</span><br><span class="line">grant    all    privileges   on   *.*   to    ‘ambari’@’localhost’;</span><br><span class="line">create   user   ‘ambari’@’namenode’   identified   by   ‘bigdata’;</span><br><span class="line">grant   all   privileges   on   *.*   to   ‘ambari’@’namenode’;</span><br><span class="line">登录ambari用户</span><br><span class="line">mysql    -u   ambari    -p</span><br><span class="line">bigdata</span><br><span class="line">create  database   ambari;</span><br><span class="line">use  ambari;</span><br></pre></td></tr></table></figure><h2 id="10-部署"><a href="#10-部署" class="headerlink" title="10.部署"></a>10.部署</h2><p> （1） yum安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum  -y  install  ambari-server (每台都要装)</span><br></pre></td></tr></table></figure></p><p>后进入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql -u ambari -p</span><br><span class="line">bigdata</span><br><span class="line">use ambari;</span><br><span class="line">source /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql;</span><br></pre></td></tr></table></figure></p><p> （2） jdk的安装<br>       下载jdk1.8.0_45安装包  放入/usr/lib/jvm/jdk1.8.0_45/ 解压<br>       配置环境变量  /etc/profile 文件最后加上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#Java environment</span><br><span class="line">       JAVA_HOME=/usr/java/jdk1.8.0_45</span><br><span class="line">PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">CLASSPATH=.:$JAVA_HOME/lib/</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export PATH</span><br><span class="line">export CLASSPATH</span><br></pre></td></tr></table></figure></p><p>执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /usr/lib/jvm/jdk1.8.0_45/bin/java 300 </span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /usr/lib/jvm/jdk1.8.0_45/bin/javac 300</span><br><span class="line">sudo update-alternatives --install /usr/bin/jar jar /usr/lib/jvm/jdk1.8.0_45/bin/jar 300</span><br></pre></td></tr></table></figure></p><p>查看当前Java版本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java  -version</span><br></pre></td></tr></table></figure></p><p> （3） 安装ambari-server    (安装在一台centos上即可，部署为ambari-server的机器)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ambari-server  setup   -j  /usr/lib/jvm/jdk1.8.0­_45/</span><br></pre></td></tr></table></figure></p><p>安装显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Using python  /usr/bin/python</span><br><span class="line"> Setup ambari‐server</span><br><span class="line">  Checking SELinux...</span><br><span class="line"> SELinux status is &apos;enabled&apos;</span><br><span class="line"> SELinux mode is &apos;permissive&apos;</span><br><span class="line">  WARNING: SELinux is set to &apos;permissive&apos; mode and temporarily disabled.</span><br><span class="line"> OK to continue [y/n] (y)?</span><br><span class="line"> Customize user account for ambari‐server daemon [y/n] (n)?</span><br><span class="line"> Adjusting ambari‐server permissions and ownership...</span><br><span class="line">  Checking firewall status...</span><br><span class="line">  Checking JDK...</span><br><span class="line"> WARNING: JAVA_HOME /usr/lib/jvm/jdk1.8.0_45 must be valid on ALL hosts  WARNING: JCE Policy files are required for configuring Kerberos security. If you plan to use Kerberos,please make sure JCE Unlimited</span><br><span class="line">  Completing setup...</span><br><span class="line">  Configuring database...</span><br><span class="line">  Enter advanced database configuration [y/n] (n)? y</span><br><span class="line">  Configuring database...  =============================================================================</span><br><span class="line">  Choose one of the following options:</span><br><span class="line">  [1] ‐ PostgreSQL (Embedded)</span><br><span class="line">  [2] ‐ Oracle</span><br><span class="line">  [3] ‐ MySQL / MariaDB</span><br><span class="line">  [4] ‐ PostgreSQL</span><br><span class="line">  [5] ‐ Microsoft SQL Server (Tech Preview)</span><br><span class="line">  [6] ‐ SQL Anywhere</span><br><span class="line">  [7] ‐ BDB  =============================================================================</span><br><span class="line"> Enter choice (3): 3</span><br><span class="line">  Hostname (localhost):</span><br><span class="line">  Port (3306):</span><br><span class="line">  Database name (ambari):</span><br><span class="line">  Username (ambari):</span><br><span class="line">  Enter Database Password (bigdata):</span><br><span class="line">  Configuring ambari database...</span><br><span class="line">  Copying JDBC drivers to server resources...</span><br><span class="line">  Configuring remote database connection properties...</span><br><span class="line">WARNING: Before starting Ambari Server, you must run the following DDL against the databa se to create the schema: /var/lib/ambari</span><br><span class="line"> Proceed with configuring remote database connection properties [y/n] (y)? y</span><br><span class="line">  Extracting system views...............</span><br><span class="line">  Adjusting ambari‐server permissions and ownership...</span><br><span class="line">  Ambari Server &apos;setup&apos; completed successfully.</span><br></pre></td></tr></table></figure></p><p> （4）启动ambari-server<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ambari-server start</span><br></pre></td></tr></table></figure></p><pre><code>启动成功后通过：http：//namenode:8080访问登录账号及密码：admin</code></pre><p> （6） 进程操作<br>    1.查看ambari进程<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps   -ef   |   grep   ambari</span><br></pre></td></tr></table></figure></p><pre><code>2.停止ambari进程</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ambari-server  stop</span><br></pre></td></tr></table></figure><pre><code>3.重启ambari进程</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ambari-server  restart</span><br></pre></td></tr></table></figure><p> （7） 修改端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi   /etc/ambari-server/conf/ambari.properties</span><br></pre></td></tr></table></figure></p><pre><code>插入或编辑以下内容Client.api.port = &lt;port_number&gt;</code></pre><h2 id="11-安装ambari-agent-每台机器都要装"><a href="#11-安装ambari-agent-每台机器都要装" class="headerlink" title="11 安装ambari-agent(每台机器都要装)"></a>11 安装ambari-agent(每台机器都要装)</h2><pre><code>1.安装ambari-agent</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum   install  ambari-agent</span><br></pre></td></tr></table></figure><pre><code>2.配置</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi  /etc/ambari-agent/conf/ambari-agent.ini</span><br></pre></td></tr></table></figure><pre><code>插入或更改以下内容<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname = namenode</span><br></pre></td></tr></table></figure></code></pre><p>最后<br>使用谷歌浏览器登录：<a href="http://namenode:8080" target="_blank" rel="noopener">http://namenode:8080</a>        账号：admin    密码：admin<br>注意：选择操作系统时，应该选择当前机器的版本。如果是本地源，<br>则需要修改HDP、HDP-UTILS的位置</p><p>If you are lucky enough, that I wish you success.<br>Said too much, tears.</p><p>如果出现ip绑定问题，修改/etc/hosts/中的ip为每台机器的真实ip<br>查看ip命令ifconfig<br>出现mysql  drive驱动问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum  install  mysql-connector-java</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-物理条件：三台centos&quot;&gt;&lt;a href=&quot;#1-物理条件：三台centos&quot; class=&quot;headerlink&quot; title=&quot;1.物理条件：三台centos&quot;&gt;&lt;/a&gt;1.物理条件：三台centos&lt;/h2&gt;&lt;p&gt;前期条件：修改每台centos的名称
      
    
    </summary>
    
      <category term="搭建" scheme="http://www.wenchong.top/categories/%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="ambari" scheme="http://www.wenchong.top/tags/ambari/"/>
    
  </entry>
  
  <entry>
    <title>centos和Ubuntu本地源制作</title>
    <link href="http://www.wenchong.top/2017/08/05/centos%E5%92%8CUbuntu%E5%88%B6%E4%BD%9C%E6%9C%AC%E5%9C%B0%E6%BA%90/"/>
    <id>http://www.wenchong.top/2017/08/05/centos和Ubuntu制作本地源/</id>
    <published>2017-08-04T16:00:00.000Z</published>
    <updated>2018-05-18T14:18:58.147Z</updated>
    
    <content type="html"><![CDATA[<h3 id="只记录那二年踏过的坑"><a href="#只记录那二年踏过的坑" class="headerlink" title="只记录那二年踏过的坑"></a>只记录那二年踏过的坑</h3><h2 id="CentOS系统"><a href="#CentOS系统" class="headerlink" title="CentOS系统"></a>CentOS系统</h2><ul><li>使用yum安装软件时，下载的* .rpm包缓存在/var/cache/yum/x86_64/7/；</li><li>创建目录</li><li><p>用于存放特定软件所需的软件包；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /opt/packages</span><br></pre></td></tr></table></figure></li><li><p>下载软件包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y --downloadonly --downloaddir=/opt/packages python-openstackclient</span><br></pre></td></tr></table></figure></li><li><p>生成repo文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y createrepo</span><br><span class="line"></span><br><span class="line">createrepo /opt/packages</span><br></pre></td></tr></table></figure></li><li><p>生成压缩包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zcf packages.tgz packages/</span><br></pre></td></tr></table></figure></li><li><p>配置本地源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">tar -zxf packages.tgz -C /opt</span><br><span class="line">vim /etc/yum.repos.d/local.repo</span><br><span class="line"></span><br><span class="line">[Local]</span><br><span class="line">name=Local Yum</span><br><span class="line">baseurl=file:////opt/packages/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure></li><li><p>客户端安装软件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install python-openstackclient</span><br></pre></td></tr></table></figure></li></ul><h2 id="Ubuntu系统"><a href="#Ubuntu系统" class="headerlink" title="Ubuntu系统"></a>Ubuntu系统</h2><ul><li>使用apt命令安装软件时，下载的* .deb包缓存在/var/cache/apt/archives/；</li><li>创建目录</li><li><p>用于存放特定软件所需的软件包；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /opt/packages</span><br></pre></td></tr></table></figure></li><li><p>下载软件包</p></li><li><p>清除旧的缓存：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -f /var/cache/apt/archives/* .deb</span><br></pre></td></tr></table></figure></li><li><p>下载软件包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install -d -y --force-yes PACKAGE-NAME</span><br></pre></td></tr></table></figure></li><li><p>拷贝软件包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /var/cache/apt/archives/* .deb /opt/packages/</span><br></pre></td></tr></table></figure></li><li><p>生成Packages.gz包<br>Packages.gz中包含软件包信息以及其依赖关系信息；</p></li><li>安装dpkg-dev以便使用dpkg-scanpackages命令生成Packages.gz文件；</li></ul><p>apt install -y dpkg-dev</p><ul><li>单机版本地源</li><li>此处忽略一切的警告(warning)；</li></ul><p>cd /opt/<br>dpkg-scanpackages packages/ /dev/null | gzip &gt; /opt/packages/Packages.gz -r</p><ul><li>制作成压缩包，便于网络传输；</li></ul><p>cd /opt/<br>tar -zcf packages.tgz packages/</p><ul><li><p>将压缩包拷贝到目标主机；</p></li><li><p>解压压缩包并配置软件源(目标主机)：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf packages.tgz -C /opt</span><br><span class="line">echo &apos;deb file:///opt/ packages/&apos; &gt; /etc/apt/sources.list</span><br></pre></td></tr></table></figure></li><li><p>临时的Web共享本地源</p></li><li><p>此处忽略一切的警告(warning)；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/packages/</span><br><span class="line">dpkg-scanpackages . /dev/null | gzip &gt; /opt/packages/Packages.gz -r</span><br></pre></td></tr></table></figure></li><li><p>使用Python自带的SimpleHTTPServer会在当前目录启动一个简易的Web服务器；</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/packages/</span><br><span class="line">python -m SimpleHTTPServer PORT</span><br></pre></td></tr></table></figure></li><li><p>配置软件源(目标主机):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;deb http://IP:PORT/ /&apos; &gt; /etc/apt/sources.list</span><br></pre></td></tr></table></figure></li><li><p>搭建Web服务共享本地源</p></li><li><p>搭建主流的Web服务：Apache服务或Nginx服务；</p></li><li>配置Web服务，根目录指向/opt/packages/；</li><li><p>配置软件源(目标主机):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;deb http://IP:PORT/ /&apos; &gt; /etc/apt/sources.list</span><br></pre></td></tr></table></figure></li><li><p>安装软件(目标主机)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install -y --force-yes PACKAGE-NAME</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;只记录那二年踏过的坑&quot;&gt;&lt;a href=&quot;#只记录那二年踏过的坑&quot; class=&quot;headerlink&quot; title=&quot;只记录那二年踏过的坑&quot;&gt;&lt;/a&gt;只记录那二年踏过的坑&lt;/h3&gt;&lt;h2 id=&quot;CentOS系统&quot;&gt;&lt;a href=&quot;#CentOS系统&quot; cla
      
    
    </summary>
    
      <category term="本地源" scheme="http://www.wenchong.top/categories/%E6%9C%AC%E5%9C%B0%E6%BA%90/"/>
    
    
      <category term="本地源" scheme="http://www.wenchong.top/tags/%E6%9C%AC%E5%9C%B0%E6%BA%90/"/>
    
  </entry>
  
</feed>
